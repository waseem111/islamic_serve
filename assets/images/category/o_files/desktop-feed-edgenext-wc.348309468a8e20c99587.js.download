(window.webpackJsonp=window.webpackJsonp||[]).push([["desktop-feed-edgenext-wc"],{"072S":function(e,t,i){"use strict";var n=i("FVZv"),a=i("rkDk");var s=function(e,t){var i=!0;return Object(a.a)(e,(function(e,n,a){return i=!!t(e,n,a)})),i},r=i("wh7w"),o=i("SEb4"),c=i("p6Gq");t.a=function(e,t,i){var a=Object(o.a)(e)?n.a:s;return i&&Object(c.a)(e,t,i)&&(t=void 0),a(e,Object(r.a)(t,3))}},"2H+z":function(e,t,i){"use strict";var n=i("yvDU"),a=i("rkDk"),s=i("wh7w"),r=i("btVS"),o=i("SEb4");t.a=function(e,t,i){var c=Object(o.a)(e)?n.a:r.a,d=arguments.length<3;return c(e,Object(s.a)(t,4),i,d,a.a)}},"7oW3":function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return s}));var n=i("G82u");class a{}function s(){a.updateLocationDisplayName.unregisterObservers(),a.fetchWeatherSummarySuccess.unregisterObservers(),a.fetchWeatherSummaryFailure.unregisterObservers(),a.patchHourlyForecastSuccess.unregisterObservers(),a.updateLocationDetectionState.unregisterObservers(),a.updateWeatherUserProfile.unregisterObservers(),a.updateCurrentLocation.unregisterObservers(),a.updateWeatherSettings.unregisterObservers(),a.updateNonmapComponmentsReadiness.unregisterObservers(),a.updateOperationFailure.unregisterObservers(),a.updateFallbackStatus.unregisterObservers(),a.updateHyperlocal.unregisterObservers(),a.openEditLocation.unregisterObservers()}a.updateLocationDisplayName=new n.a("UpdateLocationDisplayName"),a.fetchWeatherSummarySuccess=new n.a("FetchWeatherSummarySuccess"),a.fetchWeatherSummaryFailure=new n.a("FetchWeatherSummaryFailure"),a.patchHourlyForecastSuccess=new n.a("FetchHourlyForecastSuccess"),a.updateLocationDetectionState=new n.a("UpdateLocationDetectionState"),a.updateWeatherUserProfile=new n.a("UpdateWeatherUserProfile"),a.updateCurrentLocation=new n.a("UpdateCurrentLocation"),a.updateWeatherSettings=new n.a("UpdateWeatherSettings"),a.updateNonmapComponmentsReadiness=new n.a("UpdateNonmapComponmentsReadiness"),a.updateOperationFailure=new n.a("updateOperationFailure"),a.updateFallbackStatus=new n.a("updateFallbackStatus"),a.updateHyperlocal=new n.a("updateHyperlocal"),a.openEditLocation=new n.a("editLocationName")},"7qs3":function(e,t,i){"use strict";i.d(t,"a",(function(){return R}));var n,a=i("D57K"),s=i("h3hC"),r=i("ypwz"),o=i("tERu"),c=i("HxRh"),d=i("XlyT"),l=i("rvYQ"),h=i("I6Lx"),u=i("u5KZ"),p=i("6ADy"),v=i("msIb"),g=i("KETb"),f=i("k112"),b=i("KUTD"),m=i("Qo3E"),C=i("8ntK");!function(e){e[e.feedbackDefault=2224]="feedbackDefault",e[e.windowsFeed=2475]="windowsFeed"}(n||(n={}));class O{constructor(){this.manifestType="Sas",this.appId=n.feedbackDefault,this.source="Client",this.type="Idea"}}var y=i("HDSB"),S=i("4L2h"),j=i("r6MD"),A=i("/+Un"),w=i("ac9z");class I extends class{constructor(e,t){this.fetchImpl=e,this.additionalHeaders=t,this.isWindowsDashboard=l.a.AppType===r.a.NewsAndInterests||l.a.AppType===r.a.WindowsNewsPlus,this.providersServiceEndpointURL=Object(p.c)("./Msn/Providers"),this.cardActionsServiceEndpointURL=Object(p.c)("./Graph/Actions"),this.userFeedbackEventhubUrl="/labs/api/feedbackSignal",this.ocid="feeds",this.isWindowsDashboard?this.ocid="winp2":h.b.IsBlendedEnterprise&&(this.ocid="entnewsntp")}ShowFewer(e){return Object(a.a)(this,void 0,void 0,(function*(){return this.PostCardActionRequest(e,s.a.Dislike,null)}))}UnshowFewer(e){return Object(a.a)(this,void 0,void 0,(function*(){return this.DeleteCardActionRequest(e,s.a.Dislike)}))}ShowMore(e){return Object(a.a)(this,void 0,void 0,(function*(){return this.PostCardActionRequest(e,s.a.Like)}))}UnshowMore(e){return Object(a.a)(this,void 0,void 0,(function*(){return this.DeleteCardActionRequest(e,s.a.Like)}))}Save(e){return Object(a.a)(this,void 0,void 0,(function*(){return this.PostCardActionRequest(e,s.a.Save)}))}Unsave(e){return Object(a.a)(this,void 0,void 0,(function*(){return this.DeleteCardActionRequest(e,s.a.Save)}))}Hide(e){return Object(a.a)(this,void 0,void 0,(function*(){return this.PostCardActionRequest(e,s.a.Dislike,null)}))}Unhide(e){return Object(a.a)(this,void 0,void 0,(function*(){return this.DeleteCardActionRequest(e,s.a.Dislike)}))}Mute(e){return Object(a.a)(this,void 0,void 0,(function*(){return this.PostCardActionRequest(e,s.a.Mute,"SourceProvider")}))}Report(e,t,i){return Object(a.a)(this,void 0,void 0,(function*(){const n=h.b.ClientSettings?h.b.ClientSettings.aid:"";let a="";const s={serviceType:"oneservice",oneServiceTraceId:"",oneServiceActivityId:n};l.a.AppType===r.a.Windows&&(a=u.a.getPageMetadata().JoinIdProps.IDXId,s.oneServiceTraceId="",s.oneServiceActivityId=n),u.a.sendTraceInfoEvent(s);const o=JSON.stringify({article:{id:e},canvas:{name:l.a.AppType,version:navigator.userAgent,pageType:h.b.ClientSettings.pagetype},data:{activityId:n,feedbackTags:t,feedbackText:i},appEnvironment:l.a,clientSettings:h.b.ClientSettings,extSchema:s}),d=Object(p.b)().origin+this.userFeedbackEventhubUrl,g={method:"POST",headers:Object.assign(Object.assign({},yield v.a.getOneServiceHeaders()),this.additionalHeaders),body:o,credentials:"include"};let f;try{if(f=yield fetch(d,g),f.status>=400)throw new Error(f.statusText)}catch(e){u.a.sendAppErrorEvent(Object.assign(Object.assign({},c.cb.CardActionPostActionError),{message:"Error while posting action for card action",pb:Object.assign(Object.assign({},c.cb.CardActionPostActionError.pb),{customMessage:`url: ${d}, error: ${e}`})}))}return f}))}reportNonCMS(e,t,i,n){return Object(a.a)(this,void 0,void 0,(function*(){this.ReportOCV(e,t,i,n)}))}ReportOCV(e,t,i,n){return Object(a.a)(this,void 0,void 0,(function*(){let a=!1;const s="https://petrol.office.microsoft.com/v1/feedback",r=this.createOcvFeedbackData(e,t,i,n),o={method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)};try{const e=yield this.fetchImpl(s,o);if(e.ok)a=!0;else{const t=`Error code: ${e.status} Error message: ${e.statusText} Request params: ${o} Service url: ${s}`;Object(d.b)(c.cb.CardActionBadRequestReportingToOcv,"Request is not valid, it has no content, or the manifest is not formatted correctly",t)}}catch(e){const t=`Error code: ${e?e.code:"undefined"} Error message: ${e?e.message:"undefined"} Request params: ${o} Service url: ${s}`;Object(d.c)(e,c.cb.CardActionExceptionReportingToOcv,"Exception reporting feedback to OCV",t)}}))}createOcvFeedbackData(e,t,i,n){var a,s,r,o;const c=new O,d=null===h.b||void 0===h.b?void 0:h.b.ClientSettings,p=null===l.a||void 0===l.a?void 0:l.a.HostPage,v=(null==d?void 0:d.aid)||"";let g="";const f=(null===(s=null===(a=null===l.a||void 0===l.a?void 0:l.a.CurrentRequestTargetScope)||void 0===a?void 0:a.pageExperiments)||void 0===s?void 0:s.join(","))||"",b=null===(r=null===l.a||void 0===l.a?void 0:l.a.CurrentRequestTargetScope)||void 0===r?void 0:r.browser;return g=u.a.getPageMetadata().JoinIdProps.IDXId,c.submitTime=(new Date).toISOString(),c.clientFeedbackId=Object(S.e)(),c.comment=i,c.rating=4,c.application={appData:`{"ScreenResolution":"${window&&window.screen?[screen.width,screen.height].join("x"):""}","DDDActivityId":"${g}","articleId":"${e}"}`},c.telemetry={audience:(null===l.a||void 0===l.a?void 0:l.a.CurrentMarket)||"",audienceGroup:(null==p?void 0:p.verticalKey)||"Production",channel:(null==p?void 0:p.categoryKey)||"",deviceType:(null==d?void 0:d.deviceFormFactor)||"",errorClassification:JSON.stringify({NotRelevant:t.NotRelevant,ImageQuality:t.BlurryImage,MisleadingTitle:t.Misleading,OutdatedArticle:t.Outdated,DuplicateArticle:t.Duplicate,OffensiveContent:t.Offensive,Vertical:n}),featureArea:(null==d?void 0:d.pagetype)||"",flights:f,isUserSubscriber:Object(A.e)(),platform:null===(o=l.a.CurrentRequestTargetScope)||void 0===o?void 0:o.os,processSessionId:v,sourceContext:l.a.AppType},c.web={browser:(null==b?void 0:b.browserType)||"",browserVersion:(null==b?void 0:b.version)||"",sourcePageName:(null==p?void 0:p.subcategoryKey)||"",sourcePageURI:""},c}ReportAd(e,t){return Object(a.a)(this,void 0,void 0,(function*(){const i=e.concat("&f="+t);let n=new Image(1,1);n.src=i,n=null}))}GetProviderIcon(e){return Object(a.a)(this,void 0,void 0,(function*(){const t=yield this.GetPublisherDetails(e);return Object(j.a)(t,"value[0].logos[0].imageLink.href",void 0)}))}PostCardActionEvent(e,t,i,n=(()=>null),r,o,c=!0,d,l=5e3){return Object(a.a)(this,void 0,void 0,(function*(){switch(t){case s.a.ShowMore:return e&s.b.showMore?(c&&m.a.renderToast({id:C.a.ShowMore+"-"+i,toastType:C.a.ShowMore,expirationInMs:l,onClick:()=>{r?r(i,e^s.b.showMore,t,!0):this.PostCardActionEvent(e^s.b.showMore,t,i,n)},referrerButton:d}),yield this.ShowMore(i)):(m.a.expireToast(C.a.ShowMore+"-"+i),yield this.UnshowMore(i)),n(i,e);case s.a.ShowFewer:return e&s.b.showFewer?(c&&m.a.renderToast({id:C.a.ShowFewer+"-"+i,toastType:C.a.ShowFewer,expirationInMs:l,onClick:()=>{r?r(i,e^s.b.showFewer,t,!0):this.PostCardActionEvent(e^s.b.showFewer,t,i,n)},referrerButton:d}),yield this.ShowFewer(i)):(m.a.expireToast(C.a.ShowFewer+"-"+i),yield this.UnshowFewer(i)),n(i,e);case s.a.Save:return e&s.b.saved?(c&&m.a.renderToast({id:C.a.Save+"-"+i,toastType:C.a.Save,expirationInMs:l,referrerButton:d}),yield this.Save(i)):(m.a.expireToast(C.a.Save+"-"+i),yield this.Unsave(i)),n(i,e);case s.a.Hide:return e&s.b.hide?yield this.Hide(i):yield this.Unhide(i),n(i,e);case s.a.Mute:yield this.Mute(o);break;case s.a.ReportAd:return n(i,e);default:return}}))}GetPublisherDetails(e){return Object(a.a)(this,void 0,void 0,(function*(){const t=this.providersServiceEndpointURL,i={method:"GET",headers:Object.assign(Object.assign({},yield v.a.getOneServiceHeaders()),this.additionalHeaders)};[{key:"ids",value:e},...yield this.getOneServiceCommonParam()].forEach(e=>e.value&&t.searchParams.set(e.key,e.value));try{const n=yield Object(g.b)(()=>Object(a.a)(this,void 0,void 0,(function*(){return yield this.fetchImpl(t.href,i)})),"getProviderDetails");if(!n.ok){const i=`OneService returned error response. Status: ${n.status} for providerId: ${e} (url: ${t.href}`;throw new Error(i)}return n.json()}catch(e){u.a.sendAppErrorEvent(Object.assign(Object.assign({},c.cb.CardActionGetActionError),{message:`Error while calling getPublisherDetails action for card action: url: ${t.href}, error: ${e}`}))}}))}DeleteCardActionRequest(e,t){return Object(a.a)(this,void 0,void 0,(function*(){const i=this.cardActionsServiceEndpointURL,n={method:"DELETE",credentials:"include",headers:Object.assign(Object.assign({},yield v.a.getOneServiceHeaders()),this.additionalHeaders)};[{key:"$filter",value:`actionType eq '${t}' and targetId eq '${e}'`},...yield this.getOneServiceCommonParam()].forEach(e=>e.value&&i.searchParams.set(e.key,e.value));try{const s=yield Object(g.b)(()=>Object(a.a)(this,void 0,void 0,(function*(){return yield this.fetchImpl(i.href,n)})),"deleteCardAction"+t);if(s.status>=400){const i=`OneService returned error response. Status: ${s.status} for actionType: ${t} and targetId: ${e}`;throw new Error(i)}return Object(f.a)(this.getPreloadReloadReason(t)),Object(w.e)(),s}catch(e){u.a.sendAppErrorEvent(Object.assign(Object.assign({},c.cb.CardActionDeleteActionError),{message:`Error while calling delete action for card action: url: ${i.href}, error: ${e}`}))}}))}PostCardActionRequest(e,t,i){return Object(a.a)(this,void 0,void 0,(function*(){const n=this.cardActionsServiceEndpointURL,s={method:"POST",body:JSON.stringify({actionType:t,targetId:e,targetType:i}),headers:Object.assign(Object.assign({},yield v.a.getOneServiceHeaders()),this.additionalHeaders),credentials:"include"};(yield this.getOneServiceCommonParam()).forEach(e=>e.value&&n.searchParams.set(e.key,e.value));try{const r=yield Object(g.b)(()=>Object(a.a)(this,void 0,void 0,(function*(){return yield this.fetchImpl(n.href,s)})),"getCardAction"+t);if(r.status>=400){const n=`OneService returned error response. Status: ${r.status} for actionType: ${t}, targetId: ${e} and targetType: ${i}`;throw new Error(n)}return Object(f.a)(this.getPreloadReloadReason(t)),Object(w.e)(),r.json()}catch(e){u.a.sendAppErrorEvent(Object.assign(Object.assign({},c.cb.CardActionPostActionError),{message:`Error while posting action for card action: url: ${n.href}, error: ${e}`}))}}))}getOneServiceCommonParam(){return Object(a.a)(this,void 0,void 0,(function*(){return this.isWindowsDashboard?v.a.getOneServiceParamsWithoutAuth(l.a.UserId,this.ocid,!1):(yield this.isUserSignedIn())?v.a.getOneServiceParamsWithAuth(l.a.UserId,this.ocid,!h.b.IsBlendedEnterprise):v.a.getOneServiceParamsWithoutAuth(l.a.UserId,this.ocid,!h.b.IsBlendedEnterprise)}))}isUserSignedIn(){return Object(a.a)(this,void 0,void 0,(function*(){if(h.b.UserIsSignedIn)return!0;return(yield Object(A.d)())===o.c.SignedIn}))}getPreloadReloadReason(e){switch(e){case s.a.Mute:return b.a.MutePublisher;case s.a.Save:return b.a.Save;case s.a.Like:return b.a.Like;case s.a.Dislike:return b.a.Dislike;default:return b.a.SettingsChange}}}{constructor(e,t){let i;i=e||(Object(y.a)()?window.fetch.bind(window):fetch),super(i,t)}}let T;const R=(e,t)=>T||(T=new I(e,t),T)},"8ntK":function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.Save="Save",e.Mute="Mute",e.Follow="Follow",e.Unfollow="Unfollow",e.InterestFailure="InterestFailure",e.ShowMore="ShowMore",e.ShowFewer="ShowFewer",e.Hide="Hide",e.DisableNotification="DisableNotification",e.EnableNotification="EnableNotification",e.Refresh="Refresh"}(n||(n={}))},AMBy:function(e,t,i){"use strict";function n(e,t){return"function"==typeof IntersectionObserver?new IntersectionObserver(e,t):null}i.d(t,"a",(function(){return n}))},Cj5D:function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return d}));var n,a,s=i("C4R5"),r=i("HS3Q"),o=i("+qLX"),c=i("w0HK");function d(e,t){e&&t?Object(s.a)().pushHistory(r.a.Personalize,"",{isRequestFromSdCardAddRemoveClick:!0}):e&&Object(c.a)().switchPivot({pivotId:e.pivotId,configIndexHref:e.configIndexHref,configIndexRef:e.configIndexRef,context:Object.assign(Object.assign({},e.context),{isRequestFromSdCardAddRemoveClick:!0}),telemetryPageName:o.a.Interests,display:e.displayName})}!function(e){e.SwitchToPageSettings="SwitchToPageSettings",e.SwitchToNewsSettingsInPersonalizePivot="SwitchToNewsSettingsInPersonalizePivot"}(n||(n={})),function(e){e.edgePageSettings="EdgePageSettings",e.chromiumPageSettings="ChromiumPageSettings",e.proActiveCanvasSettingHandler="ProActiveCanvasHandler",e.localStorageSettings="LocalStorageSettings"}(a||(a={}))},FVZv:function(e,t,i){"use strict";t.a=function(e,t){for(var i=-1,n=null==e?0:e.length;++i<n;)if(!t(e[i],i,e))return!1;return!0}},JFdr:function(e,t,i){"use strict";var n=Math.floor,a=Math.random;t.a=function(e,t){return e+n(a()*(t-e+1))}},KPQt:function(e,t,i){"use strict";var n=i("XAMW"),a=i("b8Mt"),s=i("wh7w");t.a=function(e,t){return Object(n.a)(e,Object(s.a)(t,3),a.a)}},Qo3E:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("u5KZ"),a=i("XlyT"),s=i("HxRh");class r{static renderToast(e){this.renderToastCallback?this.renderToastCallback(e):n.a.sendAppErrorEvent(Object(a.a)(s.Fi,"Undefined toast render callback function"))}static setRenderToastCallback(e){this.renderToastCallback=e}static expireToast(e){this.expireToastCallback?this.expireToastCallback(e):n.a.sendAppErrorEvent(Object(a.a)(s.Ei,"Undefined toast expire callback function"))}static setExpireToastCallback(e){this.expireToastCallback=e}static setCurrentToast(e,t){this.currentToastId!==e&&(this.currentToastId=e,this.renderToastCallback=t,this.currentToastIdChangeCallbacks.forEach(t=>t(e)),this.renderToast())}static addCurrentToastIdChangeCallback(e){e&&this.currentToastIdChangeCallbacks.push(e)}}r.currentToastIdChangeCallbacks=[]},RAp8:function(e,t,i){"use strict";i.r(t),i.d(t,"ToolingInfo",(function(){return ri})),i.d(t,"RenderFeedType",(function(){return ft})),i.d(t,"SDCardMenuOperation",(function(){return Bt})),i.d(t,"DesktopFeedEdgeNextWC",(function(){return $t})),i.d(t,"LegacyPrefetchBehavior",(function(){return te})),i.d(t,"ColdStartDisplayType",(function(){return ie})),i.d(t,"DesktopFeedEdgeNextWCTemplate",(function(){return ni})),i.d(t,"DesktopFeedEdgeNextWCStyles",(function(){return si}));var n=i("C49W"),a=i("sydv"),s=i("nkry"),r=i("tZnx"),o=i("A03o"),c=i("akWC"),d=i("Zn5T");const l=Object(n.b)("filterDomain","Domain list which should be filtered","",Object.assign({},Object(a.b)("domain","domain should be filtered"))),h=Object(n.f)("motionThumbConfig","Config for motion thumbnail","",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Object(n.c)("EnableCaption","Enable Caption")),Object(n.c)("EnableMuteControl","Enable Mute Control")),Object(n.c)("EnablePlayingContext","Enable Playing Context")),Object(n.c)("EnableProgressBar","Enable ProgressBar")),Object(n.c)("EnableVolumeControl","Enable Volume Control")),Object(n.d)("ProgressBarPadding","ProgressBar Padding"))),u=Object(n.f)("pivotSelectionInfo","Info for pivot switch","",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Object(a.c)("pivotId","The ID of the pivot")),Object(a.c)("configIndexHref","The config index href")),Object(a.c)("telemetryPageName","The pagename of this pivot to be used for telemetry purposes")),Object(a.c)("telemetryPivotCategory","The category of this pivot")),Object(a.c)("display","The display string")),Object(a.c)("branding","The custom branding")),Object(n.f)("baseDynamicTargetUrl","the base external url for dynamic query operation","",Object.assign(Object.assign({},Object(a.c)("href","Link address to the new page")),Object(n.c)("openInNewTab","flag to determine if the link opens in new tab"))))),p=Object(n.f)("CarouselType","Carousel type","",Object.assign(Object.assign({},Object(a.c)("InfoPane","based on InfoPane")),Object(a.c)("HorizontalSlider","based on MsftHorizontalSlider"))),v=Object(n.f)("DataMapperType","DataMapperType","",Object.assign(Object.assign({},Object(a.c)("Reco","data schema is VideoCardInfo")),Object(a.c)("OneService","data schema is OneService"))),g=Object(n.f)("NavigateDestination","NavigateDestination","",Object.assign(Object.assign(Object.assign(Object.assign({},Object(a.c)("VDP","navigate to bing video detail page")),Object(a.c)("Overlay","show a overlay iFrame player")),Object(a.c)("Original","go to original site")),Object(a.c)("Watch","navigate to Watch experience"))),f=Object(n.f)("BingMotionThumbPreviewType","Motion thumb preview type","",Object.assign(Object.assign({},Object(a.c)("Auto","autoplay")),Object(a.c)("Hover","play the motion thumb when hover"))),b=Object(n.f)("BingVideoCardStyleType","Slide bing video card style","",Object.assign(Object.assign({},Object(a.c)("Append","below the static-thumb")),Object(a.c)("Cover","cover on static-thumb"))),m=Object(n.f)("adTemplateConfig","Ad template configuration","",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Object(s.b)("allowedAssets","a list of IDs allowed decoration assets","",[Object(n.a)("array"),Object(r.a)()])),Object(n.c)("immersiveThemeColor","whether enable theme color for immersive")),Object(n.d)("discountThreshold","threshold to show discount")),Object(a.c)("templateType","type of template for an ad card to use")),Object(n.c)("adCarousel","whether multi ad carousel style is turned on")),Object(a.c)("animatedImage","image animation type: scale-up/scale-down/scale-up-down")),Object(n.c)("progressiveDisplay","whether progressive decoration is turned on")),Object(n.c)("templateSelection","whether client side template selection logic is enabled")),Object(n.c)("flipZIndex","whether image is on top or bottom for z-index template, true: top; false: bottom")),Object(a.c)("configType","type of config for an ad card to use")),Object(n.f)("animatedConfig","animation config properties","",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Object(n.d)("delayTimeMs","animation parameter - delayTimeMs")),Object(n.d)("duration","animation parameter - duration")),Object(a.c)("durationString","animation parameter - durationString")),Object(a.c)("scaleFrom","animation parameter - scaleFrom")),Object(a.c)("scaleTo","animation parameter - scaleTo")))),Object(n.f)("slideshowProps","slide show properties","",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Object(n.c)("autoScroll","whether images are automatically scrolled on start")),Object(n.d)("psuedoVideoAllocation","whether pseudo video is enabled side by side with slideshow")),Object(n.d)("psuedoVideoScrollInterval","interval to move to next image")),Object(n.d)("slideshowScrollInterval","interval to move to next image")),Object(n.d)("maxImageCount","maximum image supported by slideshow")))),Object(n.f)("imageSizeConfig","auction call image size properties","",Object.assign(Object.assign({},Object(n.f)("infopane","image size for infopane section","",Object.assign(Object.assign({},Object(n.d)("w","width for infopane image")),Object(n.d)("h","height for infopane image")))),Object(n.f)("river","image size for river section","",Object.assign(Object.assign({},Object(n.d)("w","width for river image")),Object(n.d)("h","height for river image"))))))),C=Object(n.f)("bingVideoCardConfig","config for bing video carousel","",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Object(a.c)("bingVideoDetailPageFormat","Bing video detail page src format")),Object(a.c)("bingVideoOverlayPlayerHeight","Bing video overlay player height")),Object(a.c)("bingVideoOverlayPlayerWidth","Bing video overlay player width")),Object(a.c)("bingVideoPlayerSrcFormat","Bing video player src format for iframe")),Object(n.c)("carouselAutoRotate","Enable/disable auto-rotate feature")),Object(n.d)("carouselRotationInterval","Carousel auto-rotate interval")),p),Object(n.c)("checkBingEmbed","Check embeddable in bing or not")),v),l),Object(a.c)("headerSeeAllDestinationUrl","See all of header destination url")),Object(a.c)("headerTitleDestinationUrl","Title of header destination url")),Object(a.c)("horizontaItemHeight","Hight for the horizontal item")),Object(a.c)("horizontaItemWidth","Width for the horizontal item")),g),h),u),Object(a.c)("opalRecoFeedbackUrl","Feedback url for opal reco personalization")),f),Object(a.c)("seeMoreDestinationUrl","Seemore button destination url")),b)),O=Object(n.f)("trendingNewsConfig","config for trending now","",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Object(a.c)("contentId","Content id for trending now")),Object(n.d)("numberOfTermsToDisplay","Number of trending now terms to display")),Object(a.c)("ocid","Ocid override to use for oneservice call")),Object(n.d)("timeoutMs","Timeout in ms for oneservice call")),Object(a.c)("oneServiceId","One service interest id for trending now")),Object(a.c)("headingLink","Key to indicate link for the trending now card")),Object(n.d)("headlineLineLength","Key to indicate maximum length for headlines")),Object(n.f)("gradientBackground","radient background treatment for serendipity card","",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Object(a.c)("darkBackgroundColor","background color for card in dark mode")),Object(a.c)("lightBackgroundColor","background color for card in light mode")),Object(a.c)("darkTitleColor","trending and recommended title color in dark mode")),Object(a.c)("lightTitleColor","trending and recommended title color in light mode")),Object(a.c)("titleFontSize","trending and recommended title font size"))))),y=Object(n.f)("sportsCardConfig","config for sports card","",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Object(n.c)("enableHideCard","Enable hide card menu")),Object(n.b)("sportsSegments","Market segment map","",Object(n.e)("sports segment","sports segment",Object.assign(Object.assign(Object.assign({},Object(a.c)("market","market")),Object(a.c)("sportsVertical","sports vertical")),Object(a.c)("leagueSegment","league segment"))))),Object(n.b)("disableMatchClickThroughBySport","Click disabled match list","",Object(a.b)("disable matchClick throughBy Sport",""))),Object(n.c)("disableCardAction","Disable the card action button")),Object(n.c)("enableGradientBackground","Enable gradient background"))),S=Object(o.a)(d.a.desktopFeedEdgeNextWC,"Edge next desktop feed",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Object(c.a)({followText:"Follow",followingText:"Following",seeMoreMoney:"See more",moneyCardMarketTitle:"MONEY | MARKET",moneyCardWatchlistTitle:"MONEY | WATCHLIST",moneyCardAddSymbolTitle:"< MONEY | ADD SYMBOLS",addSymbolOptStr:"Add symbols",signinOptStr:"Sign in to see your watchlist",hideCardOptStr:"Hide money card",dataProviderOptStr:"Data provider",moreSettingOptStr:"More settings",addSymbolBtnStr:"+ Add Symbols",emptyWatchlistStr:"Your list is empty.",quoteItemToolTip:"Click to see more information",moneyCardSuggestedQuotesTitle:"Suggested For You",cancelText:"Cancel",seeMoreSports:"See more {0}",sportsStateFinal:"Final",sportsTBA:"TBA",trafficHeading:"TRAFFIC",via:"via",viewMapText:"View map",menuHideTrafficCard:"Hide traffic card",fasterThanUsual:"Faster Than Usual",noTraffic:"No Traffic",moderateTraffic:"Moderate Traffic",heavyTraffic:"Heavy Traffic",topPicksHeadingText:"Top Picks for You",JustNow:"just now",NumberDayAgo:"{0}d ago",NumberDaysAgo:"{0}d ago",NumberHourAgo:"{0}h ago",NumberHoursAgo:"{0}h ago",NumberMinuteAgo:"{0}m ago",NumberMinutesAgo:"{0}m ago",TimeYesterday:"yesterday at {0}",hideStoryTitle:"Got it! We won't show you this story in the future",undoHideButtonText:"Undo",personalizeButtonText:"Personalize my feed",shoppingHeading:"Today's Deal",trafficMapAltText:"Traffic Map",nativeAdShopNowText:"Shop now",nativeAdCurbsidePickupText:"Curbside pickup",nativeAdOnSaleText:"{0}% off",nativeAdPriceDropText:"Price drop",nativeAdInStoreText:"In Store",nativeAdNewProductText:"New",nativeAdFreeShippingText:"Free Shipping",nativeAdInstallmentPriceFormatNow:"{0} now",nativeAdInstallmentPriceFormatPlan:"{0}/mo x {1}",nativeAdPriceDropShortText:"{0}% price drop",nativeAdPriceDropLongText:"Price dropped {0}% below its {1} days average",nativeAdTopViewedShortText:"{0}+ viewed",nativeAdTopViewedLongText:"More than {0} people from Bing viewed this product in the last {1} days",nativeAdReplayVideoText:"Replay video",nativeAdViewDetailsText:"View details",nativeAdViewDiscountText:"View discount",nativeAdGuessPriceText:"Guess the Price",nativeAdCorrectText:"Correct!",nativeAdGuessAgainText:"Guess again!",videoAdLearnMoreText:"Learn more",cardActionsTooltips:{undoShowMore:"undo",showMore:"showMore",hide:"hide",undoShowFewer:"undo",showFewer:"showFewer",save:"save",seeMore:"seeMore",undoSave:"undo"},moneyCardTabs:{watchlist:{title:"Watchlist",seeMore:"See Watchlist"},market:{title:"Market",seeMore:"See Market"},recent:{title:"Recent",seeMore:"See Recent"},currencies:{title:"Currencies",seeMore:"See Currencies"},movers:{title:"Movers",seeMore:"See Movers"},gainers:{title:"Gainers",seeMore:"See Gainers"},losers:{title:"Losers",seeMore:"See Losers"}},moneyCardHeaderTitle:"Money",reportAdDialogRepeatedAdText:"Seen this ad multiple times",reportAdDialogInappropriateAdText:"Ad was inappropriate",reportAdDialogNotInterestedText:"Not interested in this ad",reportAdDialogMisleadingAdText:"Misleading ad or spam",cardActionMenuItemReport:"Report an issue",reportDialogSaveButtonText:"Submit",reportDialogConfirmationText:"Thank you for your feedback!",bingVideoHeaderSeeAll:"See all",bingVideoHeaderTitle:"Trending Videos for you",bingVideoNoPreviewStr:"No Preview",bingVideoPreviewStr:"Preview",bingVideoTag:"Videos",bingVideoViews:"{0} views",seeMoreVideos:"See more videos",infoPanePreviousFlipperTitle:"Previous slide",infoPaneNextFlipperTitle:"Next slide"})),Object(a.c)("fontFamilyOnCardContent","Specify the new font family to use","Specify the new font family to use",["Bierstadt","Grandview","Seaford","Tenorite"])),Object(n.d)("expectedColdStartPosition","")),Object(n.c)("upsellLaunchesInline","")),Object(n.c)("scrollDownTopSiteInf","In Informational layout, scroll down page to hide top site if top site is collapsed.")),Object(n.c)("invertSlugPosition","Flag to define if slug position needs to be inverted with the ad text")),Object(n.c)("isRightBottomAdsBingIcon","Flag to define if ads bing icon needs to be fixed in right bottom when ads icon is on top of text content")),Object(n.c)("isNewPrefetchlogic","using new prefetch logic or not")),Object(n.d)("numOfSectionsToPrefetch","num of un-rendered sections left to prefetch feed data")),C),m),O),y),Object(n.c)("enableWillChange","EnableWillChange")),Object(n.c)("enableContentTypeIndications","EnableContentTypeIndications")),Object(n.c)("miniMediaIndicatorsIcons","Smaller media indicators icons")),Object(n.c)("showColorfulHalfUContentCard","show colorful 0.5u card or not")),Object(n.c)("useColorfulInfopane","Use Colorful Infopane Content Cards")),Object(n.c)("isInfopaneImage43","isInfopaneImage43")),Object(n.c)("isInfopaneImage1610","isInfopaneImage1610")),Object(n.c)("isImage43","isImage43")),Object(n.c)("isImage1610","isImage1610")),Object(n.d)("infopaneTitleFontSize","infopaneTitleFontSize")),Object(n.c)("enableVerticalGradientInfopaneCard","enableVerticalGradientInfopaneCard")),Object(n.d)("infopaneHeadingLineHeight","infopaneHeadingLineHeight")),Object(n.d)("headingLineHeight","headingLineHeight")),Object(n.d)("cardActionBitMask","Card actions inline features bitmask")),Object(n.c)("enableHideStoryFeedback","Enables the hide story feedback card")),Object(n.c)("openPersonalizeWithoutRouter","Whether to avoid using the peregrine router when going to Personalize page; instead, when true, will use PivotManager when available")),Object(n.c)("enableGreyBlock","Enable grey block skeleton")),Object(n.c)("isBlurred","Flag indicates image is blurred")),Object(n.c)("enableAuctionInWebWorker","Flag to indicate whether we enabled auction call in web worker")),Object(n.c)("enableAdsColorBleed","Enable ads color bleed")),Object(n.c)("enableCMSAdsInWebWorker","Flag to indicate whether we enabled cms ads call in web worker")),Object(n.c)("noCardFiltering","Flag to avoid filtering SD cards")),Object(a.c)("contentTTVR","ContentTTVR","Type of Content Wait for TTVR",["infoPane","2rows","full"],"infoPane")),Object(n.c)("enableScrollMetrics","Enable scroll metrics")),Object(n.c)("noBackPlateOnHover","no BackPlate on hover")),Object(n.c)("enableFilledIconOnHover","Enables filled icon on hover")),Object(n.c)("largeSizeReactionIcons","Enables the large size reaction icons")),Object(n.c)("smallSizeReactionIcons","Enables the small size reaction icons")),Object(n.c)("isTransparentAdSlugWithBorder","whether enable the new ad slug with transparent background and border")),Object(n.c)("enableDarkTwoColumnCard","Flag to indicate whether we enable dark color for two column article card")),Object(n.c)("enableOneColumn","Enable one column")),Object(n.c)("enableInfopaneLike2cCard","Config to make 2c card in article template displays like it in infopane template")),Object(n.c)("enableLinearFeed2cVerticalGradientCard","make 2c card in linear feed gradient verticaly")),Object(n.c)("autoHideQuickLinksInAlways","Auto hide quick links in always layout")),Object(n.c)("useVenusCardHeight","Use venus card height calculated by layout gap")));var j,A=i("D57K"),w=i("7qs3"),I=i("VFke"),T=i("cxul"),R=i("hdNv"),P=i("EcDr"),M=i("HN5f"),k=i("s9+9"),E=i("+Ht2"),F=i("LJMo");!function(e){e[e.largeGap=10]="largeGap",e[e.midGap=8]="midGap",e[e.tinyGap=6]="tinyGap",e[e.miniGap=4]="miniGap"}(j||(j={}));const D=()=>!!Object(E.c)(k.a.ChromiumPageSettings).getCurrentState().verticalTabsOpened,x=e=>Boolean(e&&e in j),N=e=>!e,L=e=>{const{layoutGap:t,horizontalTabLayoutGap:i,consumeVerticalTab:n}=e,a=n&&!D()?i:t;return x(a)?a:void 0},U=e=>{const{reverseLayoutGap:t}=e;if(N(t)){const t=L(e);return x(t)?{gap:t+"px"}:void 0}},W=e=>{const{enableWillChange:t}=e;if(t)return{"will-change":"auto"}},B=e=>t=>{if(e===F.a.ShoppingCarousel)return;const{fixedCardHeight:i,reverseLayoutGap:n,useVenusCardHeight:a}=t;if(!N(n))return;const s=L(t);if(!i&&!a||!x(s))return;return{"grid-auto-rows":((304-s)/2).toFixed(1)+"px"}};var H=i("u5KZ"),$=i("JnE6");var q=i("Jw3B"),V=i("plCa"),G=i("0dho");class z{constructor(e,t){this.props=e,this.listener=t,this.onBreakpointChange=(e=this.manager.currentColumnArrangement)=>{const t=this.calcColumnArrangement(e);this.listener(t)}}updateProps(e){Object.assign(this.props,e)}attach(){this.manager.subscribe(this.onBreakpointChange)}detach(){this.manager.unsubscribe(this.onBreakpointChange)}calcLayout(e){switch(e){case q.a.c1:return this.props.enableOneColumn?q.a.c1.toUpperCase():q.a.c2.toUpperCase();case q.a.c5:return G.a.fiveColSupported()?q.a.c5.toUpperCase():q.a.c4.toUpperCase();default:return e.toUpperCase()}}get manager(){return Object(V.a)()}calcColumnArrangement(e){return this.props.hasRightRail?this.updateColumnArrangementForRightRail(e):e}updateColumnArrangementForRightRail(e){switch(e){case q.a.c5:return q.a.c4;case q.a.c4:return q.a.c3;case q.a.c3:return q.a.c2;default:return e}}}var Q=i("+qLX"),_=i("9RHM"),J=i("w0HK");const K=(e,t,i)=>{var n;return e.id===t&&(null!==(n=e.metadata)&&void 0!==n||(e.metadata={}),e.metadata.actions=i,!0)};class X{constructor(e){this.cardAction=e,this.openCardAction=e=>{this.cardAction.updateCardActionProps(e)},this.updateCardAction=(e,t,i)=>{const n=Object(R.i)(t),a=i.riverSectionFeedLayoutData.map(t=>{const[a,s]=this.buildMetadata(t.cardMetadataList,e,n);return s?this.createFeedData(t.templateId,a,i):t});i.riverSectionFeedLayoutData=a},this.goToPersonalizeCallback=(e,t)=>{var i;if(!e)return;const n=Object(J.a)();let a="muted-publishers"===t?{isRequestFromMutePublisherToast:!0,noScroll:!0}:{};(null===(i=e.context)||void 0===i?void 0:i.navigateToPersonalize)&&(a=e.context),n.switchPivot({pivotId:e.pivotId,configIndexHref:e.configIndexHref,configIndexRef:e.configIndexRef,context:Object.assign(Object.assign({},a),{isRequestFromSdCardAddRemoveClick:!1}),telemetryPageName:Q.a.Interests,display:e.displayName})}}buildMetadata(e=[],t,i){return e.reduce(([e,n],a)=>{if(a.type===F.a.Infopane){const s=a,r=s.subItems.some(e=>K(e,t,i));return[e.concat(s),n||r]}const s=a,r=K(s,t,i);return[e.concat(s),n||r]},[[],!1])}createFeedData(e,t,i){return{feedData:i.mapFeedData(t,e,-1,!1,i.riverSectionTelemetryObject),templateId:e,cardMetadataList:Object(_.a)(t)}}}const Y=e=>e.type===F.a.Infopane,Z=e=>e.type===F.a.NativeAd,ee=e=>e.type===F.a.CmsAd;var te,ie,ne,ae=i("jE1l"),se=i("mXQk"),re=i("wXkv"),oe=i("Bwzq");!function(e){e.Disabled="disabled",e.OnScroll="onScroll",e.Alwasy="always"}(te||(te={})),function(e){e.Modal="Modal",e.Upsell="Upsell"}(ie||(ie={})),function(e){e.Long="long",e.Short="short"}(ne||(ne={}));var ce=i("f/Yt"),de=i("Uw7R"),le=i("+djJ"),he=i("XlyT"),ue=i("HxRh"),pe=i("YUMq"),ve=i("rGfm"),ge=i("Z3LZ"),fe=i("+8mm"),be=i("5Aq4"),me=i("tERu"),Ce=i("BQg2"),Oe=i("rvYQ"),ye=i("VbA2"),Se=i("msIb"),je=i("6ADy"),Ae=i("KETb"),we=i("XMfh"),Ie=i("ac9z"),Te=i("/+Un");class Re{constructor(e){this.config=e}fetch(e){return Object(A.a)(this,void 0,void 0,(function*(){let t=this.config.initialRequest;if(e&&(t=Object.assign(Object.assign({},t),e)),!t)return H.a.sendAppErrorEvent(Object.assign(Object.assign({},ue.jh),{message:"default SDService fetch configuration was invalid"})),this.responseStatus=we.a.InvalidRequest,{status:this.responseStatus,cards:void 0};return yield this.fetchSDCards(t)}))}fetchSDCards(e){return Object(A.a)(this,void 0,void 0,(function*(){const t={credentials:"include",headers:yield Se.a.getOneServiceFeedCallHeaders(),method:"GET"},i=new URL(be.k,Object(je.b)()),n=Object(Ie.b)();this.requestQueryParams=new Ce.a,Object(be.o)(e,this.requestQueryParams);const a=(yield Object(Te.d)())===me.c.SignedIn?Se.a.getOneServiceParamsWithAuth(Oe.a.UserId,e.ocid,!1):Se.a.getOneServiceParamsWithoutAuth(Oe.a.UserId,e.ocid,!1);for(let e=0;e<a.length;e++)this.requestQueryParams.set(a[e].key,a[e].value);let s;Oe.a.SendFeedCallActivityIdInHeader&&this.requestQueryParams.delete(be.m.activityId),this.requestQueryParams.set(be.m.market,Oe.a.CurrentMarket),n>0&&this.requestQueryParams.set(Ie.a,n.toString()),this.requestQueryParams.get("$top")||this.requestQueryParams.set("$top","1"),this.requestQueryParams.get("User")||(this.requestQueryParams.set("User",Oe.a.UserId),this.requestQueryParams.delete(be.m.user)),i.search=this.requestQueryParams.toString();try{const e=1e4,n=yield Object(Ae.b)(()=>Object(A.a)(this,void 0,void 0,(function*(){return yield Object(ye.a)(decodeURIComponent(i.href),e,t)})),"SDCardProvider.fetch");if(!n||!n.ok){const e=n?`SDService returned error response. status: ${n.status} - ${n.statusText}`:"SDService response was null";return H.a.sendAppErrorEvent(Object.assign(Object.assign({},ue.lh),{message:e,pb:Object.assign(Object.assign({},ue.lh.pb),{customMessage:`ServiceUrl: [${i.href}], requestHeaders: [${JSON.stringify(t&&t.headers)}]`})})),void(this.responseStatus=we.a.Failed)}s=yield n.json()}catch(e){return H.a.sendAppErrorEvent(Object.assign(Object.assign({},ue.kh),{message:"Error while fetching SDService response",pb:Object.assign(Object.assign({},ue.kh.pb),{customMessage:`Error: ${e} serviceUrl: ${i.href} headers: ${JSON.stringify(t.headers)} activityId: ${Oe.a.ActivityId}`})})),void(this.responseStatus=we.a.Failed)}return s&&s.cards&&s.cards.length>0?this.responseStatus=we.a.Success:this.responseStatus=we.a.NoContent,s}))}}let Pe;const Me=e=>Object(A.a)(void 0,void 0,void 0,(function*(){let t;if(Pe)try{t=yield Pe.fetch(e)}catch(e){}return t}));var ke,Ee=i("8f7u"),Fe=i("J48h"),De=i("ssy2");class xe{constructor(e={}){this._state=e}setMoneyState(e){this._state=Object.assign(Object.assign({},this._state),e)}getMoneyState(){return Object.assign({},this._state)}}class Ne{constructor(e){this.config=e,this.addedQuoteIds=[],this.navigateToDataProvider=()=>{this.config&&window.open(this.config.financeDataProviderPage,"_blank")},this.hideCard=()=>Object(A.a)(this,void 0,void 0,(function*(){return yield this.financeUserService.enableDisableMoneyCard(!1)})),this.handleNavClick=(e,t)=>Object(A.a)(this,void 0,void 0,(function*(){let t=this.moneyStateManager.getMoneyState().multiTabQuoteItems;if(t&&t[e]||(yield this.refreshData(),t=this.moneyStateManager.getMoneyState().multiTabQuoteItems),!t)return;const i=t[e];if(e===Ee.b.Watchlist){const n=this.moneyStateManager.getMoneyState().suggestedQuoteItems||[],[a,s]=this.getCorrectWatchlist(i,n);t[Ee.b.Watchlist]=i,this.moneyStateManager.setMoneyState({cardType:Fe.c.EdgeShowData,quoteItems:a,suggestedQuoteItems:s,multiTabQuoteItems:t,activeTab:e})}else this.moneyStateManager.setMoneyState({cardType:Fe.c.EdgeShowData,quoteItems:i,activeTab:e})})),this.handleAddToWatchlist=e=>Object(A.a)(this,void 0,void 0,(function*(){let t=this.addedQuoteIds||[];t=[...t],t.includes(e)||t.push(e),this.addedQuoteIds=t})),this.refreshData=()=>Object(A.a)(this,void 0,void 0,(function*(){var e,t,i,n,a,s,r,o,c,d,l;yield Object(Ie.e)();const h=this.financeUserService.getWatchlist(),u=this.financeService.getMarketMovers(),[p,v]=yield Promise.all([h,u]),g=null!==(t=null===(e=this.config)||void 0===e?void 0:e.maxNumQuotes)&&void 0!==t?t:3,f=null==p?void 0:p.slice(0,g),b=null!==(a=null===(n=null===(i=this.config)||void 0===i?void 0:i.marketQuoteIds)||void 0===n?void 0:n.slice(0,g))&&void 0!==a?a:[],m=null!==(o=null===(r=null===(s=this.config)||void 0===s?void 0:s.currencyQuoteIds)||void 0===r?void 0:r.slice(0,g))&&void 0!==o?o:[],C=null===(c=v.active)||void 0===c?void 0:c.slice(0,g),O=null===(d=v.gainers)||void 0===d?void 0:d.slice(0,g),y=null===(l=v.losers)||void 0===l?void 0:l.slice(0,g),S=this.getSuggestedQuoteIds(f,g),j=[...f,...b,...m,...C,...O,...y,...S],A=yield this.financeService.getQuoteSummary(j),w=this.getQuoteMapIdToItem(A),I=this.getQuoteItemsByIds(w,f),T=this.getQuoteItemsByIds(w,b),R=this.getQuoteItemsByIds(w,m),P=this.getQuoteItemsByIds(w,C),M=this.getQuoteItemsByIds(w,O),k=this.getQuoteItemsByIds(w,y),E=this.getQuoteItemsByIds(w,S),[F,D]=this.getCorrectWatchlist(I,E),x={[Ee.b.Watchlist]:F,[Ee.b.Market]:T,[Ee.b.Currencies]:R,[Ee.b.Movers]:P,[Ee.b.Gainers]:M,[Ee.b.Losers]:k,[Ee.b.Recent]:[]},N={cardType:Fe.c.EdgeShowData,suggestedQuoteItems:D,multiTabQuoteItems:x},L=this.moneyStateManager.getMoneyState().activeTab;L&&(N.quoteItems=x[L]),this.moneyStateManager.setMoneyState(N)})),this.getSuggestedQuoteIds=(e,t)=>{var i,n;if(!e||e.length>=t)return[];let a=null!==(n=null===(i=this.config)||void 0===i?void 0:i.suggestedQuoteIds)&&void 0!==n?n:[];return a=a.filter(t=>!e.includes(t)),a=a.slice(0,t-e.length),a},this.getQuoteItemsByIds=(e,t)=>{if(!e||!t||0===t.length)return[];const i=[];for(let n=0;n<t.length;n+=1){const a=t[n];if(e.has(a)){const t=e.get(a);t&&i.push(t)}}return i},this.getQuoteMapIdToItem=e=>{const t=new Map;if(!e)return t;for(let i=0;i<e.length;i+=1){const n=e[i],a=n.id;t.set(a,n)}return t},this.getCorrectWatchlist=(e,t)=>{let i=e||[],n=t||[];if(t.length>0){const e=this.addedQuoteIds||[],t=n.filter(t=>e.includes(t.id));i=i.concat(t),n=n.filter(t=>!e.includes(t.id))}return[i,n]},this.financeUserService=De.FinanceServices.getFinanceUserService(),this.financeService=De.FinanceServices.getCachedFinanceService(),this.moneyStateManager=new xe}}!function(e){e[e.InvalidRequest=0]="InvalidRequest",e[e.Success=1]="Success",e[e.NoContent=2]="NoContent",e[e.Failed=3]="Failed"}(ke||(ke={}));const Le=()=>({[F.a.StockQuote]:"finance",[F.a.SportsMatch]:"sports",[F.a.SportsOlympics]:"sports",[F.a.TravelInspirationCard]:"travel",[F.a.WeatherSummary]:"weather"});function Ue(e){const{keys:t,result:i}=this,n=e.type;t.includes(n)&&i.push(Le()[n])}function We(e,t,i){var n;const{response:a}=this,s=e.type,r=null===(n=a[Le()[s]])||void 0===n?void 0:n.find(e=>e.type===s);r&&(i[t]=r)}var Be=i("r6MD");const He=["river","resriver","river_cms"],$e=e=>t=>{const i=Object.assign(Object.assign({},t),{adLabelText:e.adLabelText,isGreyAdsLabelEnabled:e.isGreyAdsLabelEnabled,isWhiteSlug:e.isWhiteSlug,isTransparentSlug:e.isTransparentSlug,isNarrowTitleFooterGap:e.isNarrowTitleFooterGap,isTransparentAdSlugWithBorder:e.isTransparentAdSlugWithBorder,isTransparentAdSlugWithBorderV2:e.isTransparentAdSlugWithBorderV2,enableAdsColorBleed:e.enableAdsColorBleed});return He.includes(t.region)?(i.isProviderInFooter=e.isProviderInFooter,i.isProviderInHeader=e.isProviderInHeader,((e,t)=>{var i;if(null===(i=t.items)||void 0===i?void 0:i.length){if(e.useArticleCardTemplate){const i=Number(t.items[0].imageWidth)||Object(Be.a)(e.adTemplateConfig,"imageSizeConfig.river.w"),n=Number(t.items[0].imageHeight)||Object(Be.a)(e.adTemplateConfig,"imageSizeConfig.river.h");return t.items[0].imageWidth=(225*i/n).toFixed().toString(),t.items[0].imageHeight="225",t.imageWidth=t.items[0].imageWidth,void(t.imageHeight=t.items[0].imageHeight)}t.items[0].imageWidth="300",t.items[0].imageHeight="156"}})(e,i),i):i},qe=(e,t)=>{var i;const n=null!==(i=e[t.region])&&void 0!==i?i:[];return Object.assign(Object.assign({},e),{[t.region]:n.concat(t)})},Ve=(e,t)=>{if(t)return t.map($e(e)).reduce(qe,{})},Ge=e=>{var t;return 0===(null===(t=e.placement.items)||void 0===t?void 0:t.length)};var ze=i("H3ag"),Qe=i("cASJ"),_e=i("MRe/");class Je{constructor(e){this.isFirstBatch=!0,this.cmsAdsConfig={documentId:"",infoPaneIndices:[],riverIndices:[]},this.infoPaneAdRegionIndexList=[],this.riverAdRegionIndexList=[],this.tabInfoPaneAdRegionIndexList=[],this.infoPaneCmsAdRegionIndexList=[],this.riverCmsAdRegionIndexList=[],this.getAdTagStyle=()=>this.nativeAdService.getAdTagStyleByLocale(),this.nativeAdService=Object(Qe.b)(),this.initializeConfig(e),Object(ge.j)().then(()=>{this.nativeAdService.loadCmsBackFillList()})}refreshNativeAdFetcher(e){this.initializeConfig(e),this.infoPaneAdRegionIndexList=[],this.riverAdRegionIndexList=[],this.tabInfoPaneAdRegionIndexList=[],this.infoPaneCmsAdRegionIndexList=[],this.riverCmsAdRegionIndexList=[],this.isFirstBatch=!0,this.nativeAdService.resetNativeAdService()}updateNativeAdFetcherRegionIndexList(e){this.appendIndexList(e);const{infoPaneAdRegionIndexList:t,riverAdRegionIndexList:i,infoPaneCmsAdRegionIndexList:n,riverCmsAdRegionIndexList:a}=this,s=n.length-this.cmsAdsConfig.infoPaneIndices.length,r=a.length-this.cmsAdsConfig.riverIndices.length;if(!(s>0||r>0))return;const{sections:o}=e,c=o.flatMap(e=>e.cards),d=c.filter(Y).flatMap(e=>e.subItems).filter(ee).reverse(),l=c.filter(ee).reverse();Array(s<0?0:s).fill(0).forEach((e,i)=>{d[i].type=F.a.NativeAd,t.push(n.pop())}),Array(r<0?0:r).fill(0).forEach((e,t)=>{l[t].type=F.a.NativeAd,i.push(a.pop())}),t.sort((e,t)=>e-t),i.sort((e,t)=>e-t)}fetchCmsAdsContent(){return Object(A.a)(this,void 0,void 0,(function*(){const e=this.generateCmsAdRequest();if(e)try{const{infoPaneIndices:t,riverIndices:i,documentId:n}=this.cmsAdsConfig,[a,s]=e.placements,r=t.splice(0,a.indices.length),o=i.splice(0,s.indices.length),{placements:c}=yield this.nativeAdService.fetchCmsAds(e,n,[...r,...o]);return this.adsConfig.perfRemoveWait||(yield Object(ge.j)()),c}catch(e){Object(he.c)(e,ue.Eb,"Call to CMS Ad Service failed")}}))}fetchSamAdsContent(e){return Object(A.a)(this,void 0,void 0,(function*(){const t=this.generateSamAdRequest();if(t&&t.placements&&0!==t.placements.length)try{ze.a.startMark("AdServiceCall.DesktopFeedEdgeNextWC");const{isFirstBatch:i,nativeAdService:n}=this,a=i?e:[];i&&(this.isFirstBatch=!1);const s=(yield Promise.all([this.nativeAdService.fetchSamAds(t,i,a),yield Object(_e.c)(this.adsConfig)]))[0],{placeHolderResponse:r,samResponse:o}=s;return this.adsConfig.perfRemoveWait||(yield Object(ge.j)()),this.generateNativeAdResponse(r,o)}catch(e){Object(he.c)(e,ue.Eb,"Call to SAM Ad Service failed")}finally{ze.a.endMark("AdServiceCall.DesktopFeedEdgeNextWC")}}))}getTemplateConfig(){return this.adsConfig.useArticleCardTemplate?this.adsConfig.adTemplateConfig:{}}generateNativeAdResponse(e,t){const i=this.getTemplateConfig(),n=this.nativeAdService.updateSamAdResponse(e,t,i),{placements:a}=n;return a.filter(e=>e.items.length)}generateSamAdRequest(){var e,t,i,n;const{infoPaneAdRegionIndexList:a,riverAdRegionIndexList:s,infoPaneCmsAdRegionIndexList:r,riverCmsAdRegionIndexList:o,tabInfoPaneAdRegionIndexList:c,samAdsInitialUpperBound:d=0,leadgenAdsInitialUpperBound:l,adsConfig:h}=this,u={placements:[]};(a.length||s.length)&&(u.placements.push({region:"infopane",indices:a.splice(0),img:null===(t=null===(e=h.adTemplateConfig)||void 0===e?void 0:e.imageSizeConfig)||void 0===t?void 0:t.infopane},{region:"river",indices:d>0?s.splice(0,d):s.splice(0),img:null===(n=null===(i=h.adTemplateConfig)||void 0===i?void 0:i.imageSizeConfig)||void 0===n?void 0:n.river}),this.samAdsInitialUpperBound=-1);const p=(e,t,i,n=0)=>{u&&e&&i.length&&u.placements.push({region:t,indices:n>0?i.splice(0,n):i.splice(0),img:this.getRegionImg(t)})},{enableInfopaneLeadgenNative:v,enableRiverLeadgenNative:g,enableDenseSlide:f,enableAuctionInWebWorker:b}=this.adsConfig;return p(v,"resinfopane",r),p(g,"resriver",o,l),p(f,"infopane-tab",c),this.leadgenAdsInitialUpperBound=-1,u.enableAuctionInWebWorker=b,u}generateCmsAdRequest(){var e,t;const{infoPaneCmsAdRegionIndexList:i,riverCmsAdRegionIndexList:n}=this,{enableInfopaneLeadgenNative:a,enableRiverLeadgenNative:s,adTemplateConfig:r}=this.adsConfig;let o;return a&&s||!i.length&&!n.length||(o={placements:[{region:"infopane_cms",indices:a?[]:i.splice(0),img:null===(e=null==r?void 0:r.imageSizeConfig)||void 0===e?void 0:e.infopane},{region:"river_cms",indices:s?[]:n.splice(0),img:null===(t=null==r?void 0:r.imageSizeConfig)||void 0===t?void 0:t.river}]}),o}appendIndexList(e){const{infoPaneAdRegionIndexList:t,riverAdRegionIndexList:i,infoPaneCmsAdRegionIndexList:n,riverCmsAdRegionIndexList:a,tabInfoPaneAdRegionIndexList:s}=this;t.push(...e.infoPaneAdRegionIndexList),i.push(...e.riverAdRegionIndexList),n.push(...e.infoPaneCmsAdRegionIndexList),a.push(...e.riverCmsAdRegionIndexList),s.push(...e.tabInfoPaneAdRegionIndexList||[])}initializeConfig(e){this.cloneCmsConfig(e.cmsAds),this.samAdsInitialUpperBound=e.samAdsInitialUpperBound,this.leadgenAdsInitialUpperBound=e.leadgenAdsInitialUpperBound,this.adsConfig=e}cloneCmsConfig(e){e&&(this.cmsAdsConfig={documentId:e.documentId,infoPaneIndices:Array.from(e.infopane),riverIndices:Array.from(e.river)})}getRegionImg(e){var t,i;switch(e){case"resriver":return null===(i=null===(t=this.adsConfig.adTemplateConfig)||void 0===t?void 0:t.imageSizeConfig)||void 0===i?void 0:i.river;default:return}}}var Ke=i("MSQM"),Xe=i("8X6I"),Ye=i("SSDD");class Ze{constructor(){this.currentRequestBatch=0,this.currentRenderBatch=0,this.unRenderedSectionBatchList=[]}reset(){this.currentRequestBatch=0,this.currentRenderBatch=0,this.unRenderedSectionBatchList=[]}recordAndUpdateRequestBatch(e){for(let t=0;t<e;t++)this.unRenderedSectionBatchList.push(this.currentRequestBatch);e>0&&this.currentRequestBatch++}checkAndUpdateRenderBatch(){const e=this.isRenderBatchExpected();return e||this.currentRenderBatch++,!e}isRenderBatchExpected(){return this.unRenderedSectionBatchList.shift()===this.currentRenderBatch}}var et=i("OpdE"),tt=i("Z118");class it{constructor(){this.contentCardMarkers=new Set,this.mapFeedTypeToExperienceIds={"content-card":d.a.articlePage,horoscopeCard:d.a.horoscopeAnswerCardWC,moneyInfoCard:d.a.moneyInfoCardWC,onThisDayCard:d.a.onThisDayCardWC,qnaCard:d.a.qna,"shopping-carousel":d.a.shoppingCardWC,sportsCard:d.a.sportsCardWC,travelDestination:d.a.travelDestination,trendingNowCard:d.a.trendingNowWC,weather:d.a.weatherCardWC},this.mapLayoutToColumns={C1:2,C2:2,C3:3,C4:4,C5:5},this.newsCardMarkerName="TTVR.ViewCards",this.sdCardsMarkerName="TTVR.SDCards",this.visualReadinessCallbackSet=!1}check(e){const t=e||"";this.contentCardMarkers.has(t)&&Object(le.d)(t)}track(e,t,i,n,a){if("full"===n)return void this.trackFull(e,t);if(!e||!e.feedData||this.visualReadinessCallbackSet||i!==tt.b.init)return;const s=e.feedData[t],r=(null==s?void 0:s.sort((e,t)=>e.card_dom_order-t.card_dom_order))||[],o=2*a*(this.mapLayoutToColumns[t]||1);let c=0;for(let e=0;e<r.length&&c<o;e++){const t=r[e],i=t.id,n=t.cardSize;if(n){let e=2;switch(n){case et.c._1x_1y:e=1;break;case et.c._1x_2y:case et.c._2x_1y:e=2;break;case et.c._2x_2y:e=4}c+=e}else c+=2;const a=this.mapFeedTypeToExperienceIds[i];if("infopane"!==i&&void 0!==i)if(a)Object(le.b)(a,this.sdCardsMarkerName,!0);else if(t.imageData){const e=i;Object(le.b)(e,this.newsCardMarkerName),this.contentCardMarkers.add(e)}}this.visualReadinessCallbackSet=!0}trackFull(e,t){if(!e||!e.feedData)return;const i=e.feedData[t],n=(null==i?void 0:i.sort((e,t)=>e.card_dom_order-t.card_dom_order))||[];for(let e=0;e<n.length;e++){const t=n[e],i=t.id,a=this.mapFeedTypeToExperienceIds[i];if("infopane"!==i&&void 0!==i)if(a)Object(le.b)(a,this.sdCardsMarkerName,!0);else if(t.imageData){const e=i;Object(le.b)(e,this.newsCardMarkerName),this.contentCardMarkers.add(e)}}}}let nt;const at={},st={},rt={};function ot(e,t="DEFAULT"){const i=at[t];if(i&&i.has(e)){(()=>i&&i.delete(e)&&0===i.size&&st[t])()&&(nt=setTimeout(()=>0===i.size&&st[t](null),200))}}function ct(e,t="DEFAULT"){nt&&clearTimeout(nt),at[t]||(at[t]=new Set),at[t].add(e)}var dt=i("W+kI"),lt=i("P4Ao");class ht{constructor(){if(this.forceCompleteTime=5e3,this.vptest=Object(dt.a)().get("vptest"),this.genTrackId=(e,t,i)=>`${e}${t?"-"+String(t):""}${void 0!==i?"-"+String(i):""}`.trim(),this.vptest){const e=lt.a.prototype.connectedCallback,t=this.genTrackId;lt.a.prototype.connectedCallback=function(){this.$emit(ht.vsReadyMark);const i=String(this.tagName).toLowerCase();switch(i){case"social-bar-wc":setTimeout(()=>ot(t(T.b.contentCard,this.contentId,P.a.socialBar)));break;default:ot(i)}e.call(this)},function(e="DEFAULT"){return rt[e]=rt[e]||new Promise(t=>{st[e]=t}),rt[e]}().then(()=>{const e=Object(de.b)();Object.assign(e,{vpready:performance.now()}),performance.mark("vpready")})}}track(e){this.vptest&&e.cardMetadataList.map(e=>{var t,i;const n=M.a[e.type];let a;if(n){switch(n){case T.b.contentCard:return a=this.genTrackId(n,null===(t=e.cardContent)||void 0===t?void 0:t.id,null==e?void 0:e.regionIndex),void Object.keys(P.a).map(t=>{var i;const a=this.genTrackId(n,null===(i=e.cardContent)||void 0===i?void 0:i.id,t);ct(a),setTimeout(()=>{ot(a)},this.forceCompleteTime)});case T.b.nativeAdCard:a=this.genTrackId(n,"",null==e?void 0:e.regionIndex);break;case T.b.infopaneCard:return void(null===(i=e.subItems)||void 0===i||i.map(e=>{var t;const i=this.genTrackId(n,null===(t=e.cardContent)||void 0===t?void 0:t.id,null==e?void 0:e.regionIndex);ct(i),setTimeout(()=>{ot(i)},this.forceCompleteTime)}));case T.b.serendipityCard:a=String(T.b.trendingNowCard);break;case T.b.shoppingCarouselCard:a=String("msn-shopping-carousel");break;default:a=String(n)||""}ct(a),setTimeout(()=>{ot(a)},this.forceCompleteTime)}})}genCheck(e,t){var i;if(!this.vptest)return;let n;switch(e){case T.b.nativeAdCard:return n=this.genTrackId(e,"",null==t?void 0:t.regionIndex),()=>ot(n);case T.b.contentCard:return n=this.genTrackId(e,null==t?void 0:t.id,null==t?void 0:t.regionIndex),e=>ot(this.genTrackId(n,e));case T.b.infopaneCard:null===(i=t.subItems)||void 0===i||i.map(t=>{var i;const n=this.genTrackId(e,null===(i=t.cardContent)||void 0===i?void 0:i.id,null==t?void 0:t.regionIndex);t.visualReadinessCallback=()=>ot(n)});break;default:return n=this.genTrackId(e,null==t?void 0:t.id,null==t?void 0:t.regionIndex),()=>ot(n)}}}let ut;ht.vsReadyMark="vsReady";let pt=!1;const vt=(e,t,i)=>{var n;if(i)return ut=i;const a=(s=e.initialRequest.feedId!==t.feedId,pt=s,pt);var s;const r=Object.assign(Object.assign({},e),{initialRequest:Object.assign(Object.assign({},e.initialRequest),{feedId:t.feedId,feedName:null!==(n=t.feedName)&&void 0!==n?n:e.initialRequest.feedName,feedSource:t.feedSource})});return ut=new tt.a(r,a)},gt=(e,t)=>e.findIndex(e=>e.type===t);var ft,bt=i("AMBy"),mt=i("bWC+"),Ct=i("7oW3"),Ot=i("/FrS"),yt=i("hme2"),St=i("I6Lx"),jt=i("oePG"),At=i("QBS5"),wt=i("DYG5"),It=i("QHbP"),Tt=i("wZHk"),Rt=i("Cj5D"),Pt=i("oIHq"),Mt=i("eoyk"),kt=i("vmYD"),Et=i("lV/q"),Ft=i("IqCT"),Dt=i("ejtM"),xt=i("S8sE");ce.a,kt.a,function(e){e[e.FirstFetchAndRenderContent=0]="FirstFetchAndRenderContent",e[e.SubFetchAndRenderContent=1]="SubFetchAndRenderContent",e[e.RenderContent=2]="RenderContent"}(ft||(ft={}));const Nt=Object(de.b)();let Lt,Ut=!1,Wt=!0;var Bt;!function(e){e.Edit="edit",e.Hide="hide",e.More="more",e.DataProvider="dataProvider"}(Bt||(Bt={}));const Ht="work";class $t extends Ft.a{constructor(){super(...arguments),this.sdCardMenuOpen=!1,this.riverSectionFeedLayoutData=[],this.riverPlaceholderData=[],this.renderedRiverCount=0,this.renderedRiverPlaceholderCount=0,this.overrideWillChangeStyles="",this.overrideGapStyles="",this.getOverrideGridStyles=e=>this.getOverrideStyles([B(e)]),this.coldStartFreResponse=null,this.hasRightRail=!1,this.previousRiverSectionContentResponse=null,this.unRenderedLayoutTemplate=[],this.unRenderedRiverContent=[],this.isFetchingContent=!1,this.isFirstFeedCall=!0,this.isSentinelInView=!1,this.isPlaceholderLowerSentinelInView=!1,this.isPlaceholderUpperSentinelInView=!1,this.enableScrollDownTopSiteInf=!1,this.initFirstDone=!1,this.readyForPrefetch=!1,this.disablePrefetchHack=!1,this.ttvrFired=!1,this.beaconService=new Pt.a,this.waitingAdsMap=new Map,this.unServedSamAdSet=new Set,this.adLabelText="Ad",this.isGreyAdsLabelEnabled=!1,this.infoPaneNativeAdsMap=[],this.tabInfoPaneNativeAdsMap=[],this.riverNativeAdsMap=[],this.cmsInfopaneNativeAdsMap=[],this.cmsRiverNativeAdsMap=[],this.awayTimestamp=1/0,this.ttvrCurrentCountMap={},this.ttvrMaxCountMap={},this.scrollRenderMetadataMap=new Map,this.throttledScheduleAndSendScrollMetrics=Object(wt.a)(this.scheduleAndSendScrollMetrics.bind(this),200),this.isGetContentForNextFeedBlocked=!1,this.paginationObserverMap=new Map,this.renderHelper=new Ze,this.layoutTemplateList=[],this.rowCountList=[],this.rowCountForTTVR=2,this.isNewTTVR=!1,this.ttvrMarkersHelper=new it,this.vpReadyHelper=new ht,this.setupPaginationObserver=e=>{e.map(([e,t])=>{const i=Object(bt.a)(t);e&&(null==i||i.observe(e),this.paginationObserverMap.set(e,i))})},this.clearPaginationObserver=()=>{this.paginationObserverMap.forEach((e,t)=>{null==e||e.unobserve(t)}),this.paginationObserverMap.clear()},this.handleDocumentVisibilityChange=()=>{"visible"===document.visibilityState?!Ut&&(Ut=!0,St.b.IsPrerender)||this.checkAwayTime():this.updateAwayTime()},this.refreshFeed=()=>{this.resetParameters(),this.renderNextFeed(tt.b.refresh)},this.callRefreshFeed=()=>{this.refreshFeed()},this.hideCardAndRefreshFeed=()=>Object(A.a)(this,void 0,void 0,(function*(){yield Object(Ie.d)(),this.refreshFeed()})),this.onScrollForPrefetch=()=>{this.enableScrollDownTopSiteInf&&document.documentElement.scrollTop<=56||(this.prefetchOnlyFirstTime(),window.removeEventListener("scroll",this.onScrollForPrefetch))},this.createArgs=(e,t,i,n)=>{var a,s;const{config:r}=this,{cardMetadata:o}=t,c=I.a[t.layoutTemplateName],{rowHeightPx:d,colWidthPx:l,gutterPx:h}=c,u=this.getVisualReadinessCallback(e,o,n),p=Object.assign(Object.assign({},t),{cardActionBitMask:r.cardActionBitMask||7,isAnaheimDesign:!0,goToPersonalizeCallback:e=>this.cardAction.goToPersonalizeCallback(this.config.oneRiverInterestsPivotInfo,e),initCardAction:null===(a=this.cardAction)||void 0===a?void 0:a.openCardAction,cardActionClickHandler:(e,t,i,n,a,s,r)=>(this.cardActionServiceClient.PostCardActionEvent(t,i,e,void 0,n&&a?a:void 0,s,r),this.cardAction.updateCardAction(e,t,this)),visualReadinessCallback:u,localizedStrings:r.localizedStrings,configOptions:Object(_.a)(r),layoutGap:(v=r.layoutGap,g=r.consumeVerticalTab,f=r.reverseLayoutGap,!f&&v&&x(v)&&(!g||g&&D())?r.layoutGap:void 0),stockImageData:r.stockImageData,enableRichSocialReaction:this.feedSource!==Ht&&r.enableRichSocialReactions,isAdFeedbackV1Enabled:Boolean(r.adFeedbackV1Enabled),handleAdFeedbackSubmit:this.cardActionServiceClient.ReportAd,useInlineSvgIcons:!0,sdCardActionClickHandler:this.sdCardMenuClickHandler,refreshFeedCallback:()=>this.refreshFeed(),refreshSDCardSection:()=>this.hideCardAndRefreshFeed(),goToPersonalizeSettingsCallback:this.navigateToPersonalizeSetting,hideCardCallback:()=>this.hideCardAndRefreshFeed(),dismissSDCardMenuCallback:this.dismissSDCardMenu,isClarityEnabled:this.config.isClarityEnabled,isIASEnabled:this.config.isIASEnabled,isBlurred:r.isBlurred,rowCount:this.rowCountList[n||0],rowHeightPx:d,colWidthPx:l,gutterPx:h});var v,g,f;return null===(s=Dt.a[e])||void 0===s||s.call(Dt.a,p,o,this,i),p},this.genTtvrCallback=(e,t,i)=>{const n=e===T.b.contentCard,a=Boolean(Object(R.b)(t)),s=n&&a&&""!==t.id;return e===T.b.infopaneCard||e===T.b.topStoriesCard?this.setVisuallyReadyMarkers:s?()=>{this.ttvrMarkersHelper.check(t.id),this.setSubsequentTtvr(i)}:this.setSubsequentTtvr.bind(this,i)},this.getVisualReadinessCallback=(e,t,i)=>{const n=this.genTtvrCallback(e,t,i),a=this.vpReadyHelper.genCheck(e,t);if(n||a)return(e=P.b.ALL,t)=>{e&P.b.TTVR&&n&&n(),e&P.b.VP&&a&&a(t)}},this.setVisuallyReadyMarkers=()=>{if(this.pageRevealRevalidatePromise){const e=this.pageRevealRevalidatePromise;this.pageRevealRevalidatePromise=void 0,window.requestAnimationFrame(()=>{setTimeout(()=>{null==e||e.set()},0)})}this.ttvrFired||(this.ttvrFired=!0,window.requestAnimationFrame(()=>{setTimeout(()=>{var e,t;Object(le.b)(d.a.desktopFeedEdgeNextWC,"TTVR.Infopane",!0),Object(le.m)(d.a.desktopFeedEdgeNextWC);const i=Object(ge.g)();i&&(null===(t=null===(e=null===fe.a||void 0===fe.a?void 0:fe.a.updateVisuallyReadyTiming)||void 0===e?void 0:e.getActionSender(i))||void 0===t||t.send(Object(ge.c)(d.a.desktopFeedEdgeNextWC,void 0,void 0,void 0,window.performance.now())))},0)}))},this.setSubsequentTtvr=e=>{this.config.enableScrollMetrics&&e&&e>0&&(this.ttvrCurrentCountMap[e]?this.ttvrCurrentCountMap[e]++:this.ttvrCurrentCountMap[e]=1,this.ttvrCurrentCountMap[e]===this.ttvrMaxCountMap[e]&&this.markScrollRenderEndTime(e))},this.refreshSDCard=()=>Object(A.a)(this,void 0,void 0,(function*(){let e=[];e=e.concat(this.getRenderedSDCardKeys()).concat(this.getUnRenderedSDCardKeys());const t=yield Me({contentType:e.join(",")});t&&(this.updateSDCard(t),this.updateUnRenderedSDCard(t))})),this.sdCardMenuClickHandler=(e,t)=>{let i={};switch(t){case T.b.weatherCard:case T.b.trafficCard:break;case T.b.moneyCard:i={[Bt.DataProvider]:this.navigateToMoneyDataProvider,[Bt.Hide]:this.hideMoney};break;case T.b.sportsCard:case T.b.sportsOlympicCard:}i[Bt.More]=this.navigateToPersonalizeSetting,e.menuItems.forEach(e=>{const t=e.id,n=i[t];n&&(e.onClick=n)}),e.onDismiss=this.dismissSDCardMenu,this.toggleSDCardMenu(e)},this.handleDocumentClick=e=>{var t,i,n,a;const s=e.composedPath()[0],r=null===(i=null===(t=this.sdCardMenuProps)||void 0===t?void 0:t.referrerButton)||void 0===i?void 0:i.contains(s),o=null===(a=null===(n=this.sdCardMenuRef)||void 0===n?void 0:n.shadowRoot)||void 0===a?void 0:a.contains(s);r||o||this.dismissSDCardMenu()},this.dismissSDCardMenu=()=>{this.sdCardMenuOpen=!1},this.toggleSDCardMenu=e=>{this.sdCardMenuProps=e,this.sdCardMenuOpen=!this.sdCardMenuOpen},this.navigateToPersonalizeSetting=()=>{var e,t;const i=this.config.oneRiverInterestsPivotInfo;if(i){if(null===(e=i.context)||void 0===e?void 0:e.navigateToPersonalize){const e=null===(t=i.children)||void 0===t?void 0:t.find(e=>"experienceSettings"===e.pivotId);e&&Object(Rt.b)(e,!1)}else Object(Rt.b)(i,!1);this.sdCardMenuOpen=!1}},this.retrieveAndUpdateSDCard=e=>Object(A.a)(this,void 0,void 0,(function*(){yield Object(Ie.e)();const t=yield Me({contentType:Le()[e]});t&&this.updateSDCard(t)})),this.navigateToMoneyDataProvider=()=>{this.money.navigateToDataProvider(),this.dismissSDCardMenu()},this.hideMoney=()=>Object(A.a)(this,void 0,void 0,(function*(){const e=yield this.money.hideCard();return this.dismissSDCardMenu(),e&&(yield this.refreshFeed()),e})),this.handleMoneyNavClick=(e,t)=>Object(A.a)(this,void 0,void 0,(function*(){yield this.money.handleNavClick(e,t),this.updateSDCard()})),this.handleRefreshMoneyData=()=>Object(A.a)(this,void 0,void 0,(function*(){yield this.money.refreshData(),this.updateSDCard()})),this.initializeColdStartExperience=()=>Object(A.a)(this,void 0,void 0,(function*(){var e,t;if(null===(e=this.config.childExperienceReferencesWC)||void 0===e?void 0:e.coldStartModal){yield Object(ge.j)();try{const e=yield Object(yt.a)().getFreArtifacts();if(!e)return;e.fre?this.coldStartFreResponse=e:(null===(t=e.subCards)||void 0===t?void 0:t.length)&&Object(he.b)(ue.sf,"FRE request was made but returned no flag or empty data")}catch(e){Object(he.c)(e,ue.Qe,"Getting data for the required artifacts failed in desktop feed when initializing cold start experience")}}})),this.closeColdStartExperience=()=>{this.coldStartFreResponse=null},this.getAdTagStyle=()=>{const{adLabelText:e,isGreyAdsLabelEnabled:t}=this.nativeAdFetcher.getAdTagStyle();this.adLabelText=e,this.isGreyAdsLabelEnabled=t},this.fetchAndHandleCmsAds=()=>Object(A.a)(this,void 0,void 0,(function*(){const e=yield this.nativeAdFetcher.fetchCmsAdsContent();e&&(this.updateCmsNativeAdMap(e),this.updateNativeAdInRiverSections())})),this.fetchAndHandleSamAds=e=>Object(A.a)(this,void 0,void 0,(function*(){const t=yield this.nativeAdFetcher.fetchSamAdsContent([e=>this.updateNativeAdMap(e.callbackFnPlacementList),()=>this.updateNativeAdInRiverSections()]);t&&0!==t.length&&(this.updateNativeAdMap(t),this.updateNativeAdInRiverSections(),this.fireServedTrackingCallForPlacements(t,e))})),this.updateNativeAdMap=e=>{const t=Ve(this.nativeAdConfig,e);if(!t)return;const{infopane:i=[],resinfopane:n=[],river:a=[],resriver:s=[],"infopane-tab":r=[]}=t;return this.infoPaneNativeAdsMap=this.infoPaneNativeAdsMap.concat(i).concat(n),this.riverNativeAdsMap=this.riverNativeAdsMap.concat(a).concat(s),this.tabInfoPaneNativeAdsMap=this.tabInfoPaneNativeAdsMap.concat(r),this}}experienceConnected(){Promise.all([Object(ge.h)(),Object(ge.j)()]).then(()=>{this.readyForPrefetch=!0}),this.breakpoint=new z({hasRightRail:this.hasRightRail,enableOneColumn:!!this.config.enableOneColumn},e=>{var t;this.layout=null===(t=this.breakpoint)||void 0===t?void 0:t.calcLayout(e)}),this.breakpoint.onBreakpointChange(),this.breakpoint.attach(),this.perfTimeline&&(this.mapFeedData=this.perfTimeline.instrumentFunc("mapFeedData",this.mapFeedData,this)),Wt&&!this.config.autoHideQuickLinksInAlways&&(this.enableScrollDownTopSiteInf=function(e){const t=Object(E.c)(k.a.TopSitesLayoutData),i=Object(E.c)(k.a.ChromiumPageSettings);if(t&&i){const n=t.getCurrentState(),a=i.getCurrentState(),s="always"===a.selectedFeedDisplaySetting;if(e&&s&&a.quickLinksEnabled&&n.isTopSitesCollapsed){const e=document.documentElement?document.documentElement:document.body;if(e){const t=e=>{e&&(e.preventDefaultScroll=!0,H.a.scheduleContentViewEvent($.b.AutoScroll)),document.removeEventListener("scroll",t)};return document.addEventListener("scroll",t),e.scrollTop=56,!0}}}return!1}(!!this.config.scrollDownTopSiteInf),Wt=!1),this.isNewTTVR=this.config.noCardFiltering||!1,document.addEventListener("visibilitychange",this.handleDocumentVisibilityChange),this.nativeAdFetcher=new Je(this.config),this.getAdTagStyle();const e=this.config.riverSectionCardProviderConfig;Pe=new Re(e),this.money=new Ne(this.config.moneyCardConfig);const{feedId:t,feedName:i,feedSource:n}=this;this.addPageConfiguration(e),vt(e,{feedId:t,feedName:i,feedSource:n},this.riverCardProvider),this.riverSectionTelemetryObject=this.telemetryObject.addOrUpdateChild({name:"River",content:{headline:t||i||"RiverSection"}}),ve.a.refreshRiver.registerObserver(()=>Object(A.a)(this,void 0,void 0,(function*(){this.refreshFeed()}))),Mt.a.updateLayout.registerObserver(()=>Object(A.a)(this,void 0,void 0,(function*(){this.overrideGapStyles=this.getOverrideStyles([U])}))),this.initFeed(),this.overrideWillChangeStyles=this.getOverrideStyles([W]),this.overrideGapStyles=this.getOverrideStyles([U]),this.cardActionServiceClient=Object(w.a)();const a=Oe.a.CurrentRequestTargetScope&&Oe.a.CurrentRequestTargetScope.pageExperiments;a&&a.includes("prg-wpo-sub-c")&&H.a.addOrUpdateTmplProperty("PUBCAR","0"),(e=>{if(!e)return;const t=`\n        @font-face {\n            font-family: ${e};\n            font-style: normal;\n            src: url("https://assets.msn.com/staticsb/statics/latest/fonts/${e.toLocaleLowerCase()}/${e.toLocaleLowerCase()}.woff2") format('woff2');\n            font-display: swap;\n        }\n        `,i=Array.from(document.head.querySelectorAll("style"));for(const e of i)if(e.innerText===t)return;const n=document.createElement("style");n.innerText=t,document.head.appendChild(n)})(this.config.fontFamilyOnCardContent)}shadowDomPopulated(){var e,t;const{shadowRoot:i}=this;if(!i)return;const n=[];if(this.config.enableGreyBlock){const{riverPlaceHolderUpperSentinel:e,riverPlaceHolderLowerSentinel:t}=this;n.push([e,this.riverPlaceholderUpperCallback.bind(this)],[t,this.riverPlaceholderLowerCallback.bind(this)])}else{const{riverSentinel:e}=this;n.push([e,this.riverPaginationCallback.bind(this)])}this.setupPaginationObserver(n);const a=Object(It.a)(Tt.a.cardAction);this.cardAction=new X(a),document.addEventListener("mousedown",this.handleDocumentClick),null===(e=this.coldStartContainerElement)||void 0===e||e.addEventListener(se.a,this.closeColdStartExperience),null===(t=this.coldStartContainerElement)||void 0===t||t.addEventListener(se.b,this.closeColdStartExperience),this.config.enableScrollMetrics&&(this.sectionIntersectionObserver=new IntersectionObserver(this.sectionVisiblityCallback.bind(this),{threshold:.2}),document.addEventListener("scroll",this.throttledScheduleAndSendScrollMetrics))}disconnectedCallback(){var e,t;window.removeEventListener("scroll",this.onScrollForPrefetch),document.removeEventListener("visibilitychange",this.handleDocumentVisibilityChange),this.breakpoint.detach(),null===(e=this.coldStartContainerElement)||void 0===e||e.removeEventListener(se.a,this.closeColdStartExperience),null===(t=this.coldStartContainerElement)||void 0===t||t.removeEventListener(se.b,this.closeColdStartExperience),this.clearPaginationObserver(),this.config.enableScrollMetrics&&document.removeEventListener("scroll",this.throttledScheduleAndSendScrollMetrics)}checkAwayTime(){const{idleTimeout:e,idleControl:t}=this.config;if(!e)return;(new Date).getTime()<this.awayTimestamp+e||(H.a.addOrUpdateTmplProperty("idleAutoRefresh","1"),H.a.sendClientLogEvent({message:"IAR is triggered",type:"information"}),t||(this.ttvrFired=!1,this.refreshFeed(),H.a.sendPageView({page:{name:"IAR",isAutoRefresh:!0}})))}updateAwayTime(){this.awayTimestamp=(new Date).getTime()}initFeed(){this.resetParameters(),this.renderNextFeed(tt.b.init)}updateFeed(){this.noPreviousResp()||Object(ge.j)().then(()=>this.renderNextFeed(tt.b.subsequent))}updatePlaceholder(){Object(ge.j)().then(()=>{const e=Array(10).fill(null).map(()=>({type:F.a.PlaceholderCard}));this.riverPlaceholderData.push({feedData:this.mapFeedData(e,"msft-ten-card-five-col",-1),templateId:"msft-ten-card-five-col",cardMetadataList:e}),this.renderedRiverPlaceholderCount=this.renderedRiverPlaceholderCount+1})}initAtFirst(){return Object(A.a)(this,void 0,void 0,(function*(){if(yield Object(Ke.a)(),this.noPreviousResp())return;this.fetchAndHandleSamAds(),this.fetchAndHandleCmsAds();const{selectedFeedDisplaySetting:e}=Object(E.c)(k.a.ChromiumPageSettings).getCurrentState();("peek"===e||this.config.legacyPrefetchBehavior===te.Disabled)&&(this.disablePrefetchHack=!0),this.config.legacyPrefetchBehavior===te.OnScroll?setTimeout(()=>window.addEventListener("scroll",this.onScrollForPrefetch)):this.prefetchOnlyFirstTime()}))}renderNextFeedWithPrefetch(e){return Object(A.a)(this,void 0,void 0,(function*(){let t=ft.RenderContent;if(this.isEmpty()){const i=this.prefetchHandler?yield this.prefetchHandler:yield this.getContentForNextFeed(e);if(!i&&!this.isFetchingContent)return void this.fallbackToRiverSentinel();if(!i)return void(this.isGetContentForNextFeedBlocked=!0);this.isFirstFeedCall&&(t=ft.FirstFetchAndRenderContent,this.isFirstFeedCall=!1)}if(!this.addRiverSections(e))return;const i=this.renderHelper.checkAndUpdateRenderBatch();switch(this.addWaitingIndex(this.riverSectionFeedLayoutData.length-1),t){case ft.FirstFetchAndRenderContent:yield this.initAtFirst();break;case ft.RenderContent:i&&(this.fetchAndHandleSamAds(),this.fetchAndHandleCmsAds()),this.updateNativeAdInRiverSections()}this.shouldPrefetch()&&(this.prefetchHandler=this.getContentForNextFeed(tt.b.subsequent).then(e=>e).catch(()=>!1).finally(()=>{this.prefetchHandler=void 0}))}))}renderNextFeed(e){return Object(A.a)(this,void 0,void 0,(function*(){if(this.config.isNewPrefetchlogic)return this.renderNextFeedWithPrefetch(e);let t=ft.RenderContent;if(this.isEmpty()){const i=yield this.getContentForNextFeed(e);if(!i&&!this.isFetchingContent)return void this.fallbackToRiverSentinel();if(!i)return void(this.isGetContentForNextFeedBlocked=!0);this.isFirstFeedCall?(t=ft.FirstFetchAndRenderContent,this.isFirstFeedCall=!1):t=ft.SubFetchAndRenderContent}this.addRiverSections(e);const i=this.riverSectionFeedLayoutData.length-1;this.addWaitingIndex(i),t===ft.FirstFetchAndRenderContent?yield this.initAtFirst():t===ft.SubFetchAndRenderContent?(this.fetchAndHandleSamAds(),this.fetchAndHandleCmsAds()):t===ft.RenderContent&&this.updateNativeAdInRiverSections()}))}renderedRiverCountChanged(){Lt&&clearTimeout(Lt),Lt=window.setTimeout(()=>{const{isSentinelInView:e}=this;if(e&&this.updateFeed(),this.config.enableScrollMetrics){const e=this.selectAllSections();e&&e.forEach((e,t)=>{var i;this.scrollRenderMetadataMap.get(e)||(this.sectionIntersectionObserver.observe(e),this.scrollRenderMetadataMap.set(e,{i:t,cc:null===(i=this.riverSectionFeedLayoutData[t].cardMetadataList)||void 0===i?void 0:i.length}))})}},100)}renderedRiverPlaceholderCountChanged(){return Object(A.a)(this,void 0,void 0,(function*(){if(0===this.renderedRiverPlaceholderCount&&this.isPlaceholderLowerSentinelInView)return yield Object(xt.a)(),void this.updatePlaceholder();0!==this.renderedRiverPlaceholderCount&&(Lt&&clearTimeout(Lt),Lt=window.setTimeout(()=>{this.updateFeed()},100))}))}addRiverSections(e){if(!this.unRenderedLayoutTemplate.length)return!1;const t=this.unRenderedLayoutTemplate.shift(),i=I.a[t],n=this.getCardMetadataForRiverSection(i);this.config.enableScrollMetrics&&this.riverSectionFeedLayoutData.length>0&&(this.ttvrMaxCountMap[this.riverSectionFeedLayoutData.length]=n.filter(e=>M.a[e.type]===T.b.contentCard&&Boolean(Object(R.b)(e))).length);const a=e=>({feedData:this.mapFeedData(e,t,this.riverSectionFeedLayoutData.length,!0,this.riverSectionTelemetryObject),templateId:t,cardMetadataList:e}),s=i=>{this.layoutTemplateList.push(t),this.rowCountList.push({});const n=a(i);this.riverSectionFeedLayoutData.push(n),this.ttvrMarkersHelper.track(n,this.layout,e,this.config.contentTTVR,this.rowCountForTTVR),e!==tt.b.init&&e!==tt.b.refresh&&this.vpReadyHelper.track(n),Nt[re.a.secondSectionRenderStart]=window.performance.now()},r=()=>{this.riverSectionFeedLayoutData=[],this.renderedRiverCount=this.riverSectionFeedLayoutData.length};return(()=>{if(e===tt.b.init||e===tt.b.refresh){r();const e=[...n];((e,t)=>{const i=gt(e,t),n=e[i],{subItems:a}=n||{};a&&e.splice(i,1,Object.assign(Object.assign({},n),{subItems:[a[0]]}))})(e,F.a.Infopane);const t=[F.a.WeatherSummary,F.a.SportsMatch,F.a.SportsOlympics,F.a.StockQuote,F.a.MoneyInfo];this.isNewTTVR||t.forEach(t=>((e,t)=>{const i=gt(e,t);-1!==i&&e.splice(i,1,Object.assign(Object.assign({},e[i]),{data:void 0}))})(e,t)),s(e),Object(ge.j)().then(()=>Object(A.a)(this,void 0,void 0,(function*(){this.riverSectionFeedLayoutData=[];const e=a(n);this.riverSectionFeedLayoutData.push(e),this.vpReadyHelper.track(e);n[n.findIndex(e=>e.type===F.a.WeatherSummary)]&&(this.weatherDataConnector||(this.weatherDataConnector=yield Object(E.a)(k.a.WeatherData),Ct.a.updateWeatherSettings.registerObserver(()=>Object(A.a)(this,void 0,void 0,(function*(){this.retrieveAndUpdateSDCard(F.a.WeatherSummary),Object(Xe.c)(Ye.a.WeatherChange)}))),this.weatherDataConnector&&this.weatherDataConnector.getCurrentState()&&this.weatherDataConnector.getCurrentState().settingUpdateStatus==Ot.f.Start&&this.retrieveAndUpdateSDCard(F.a.WeatherSummary)))})))}else s(n)})(),this.renderedRiverCount=this.riverSectionFeedLayoutData.length,this.riverPlaceholderData=this.riverPlaceholderData.slice(1),this.renderedRiverPlaceholderCount>0&&(this.renderedRiverPlaceholderCount=this.renderedRiverPlaceholderCount-1),!0}getCardMetadataForRiverSection(e){const t=[];if(!e)return t;for(let i=0;i<e.cardCount;i++){const e=this.unRenderedRiverContent.shift();e&&t.push(e)}return t}getContentForNextFeed(e){return Object(A.a)(this,void 0,void 0,(function*(){if(this.isFetchingContent)return!1;this.isFetchingContent=!0;const t=this.previousRiverSectionContentResponse;if((null==t?void 0:t.status)===we.a.NoContent)return this.isFetchingContent=!1,!1;const i=null==t?void 0:t.nextPageRequest,n=yield((e,t)=>Object(A.a)(void 0,void 0,void 0,(function*(){let i;if(ut)try{i=yield ut.fetch(e,t)}catch(e){Object(he.c)(e,ue.Fb,"Content fetch failed for Desktop Feed EdgeNext WC river section.","Failed with exception : "+e)}return i})))(i,e);if(this.isFetchingContent=!1,!n)return!1;if(this.previousRiverSectionContentResponse=n,n.status!==we.a.Success)return!1;const{sections:a}=n;for(const e of a){const{cards:t,layoutTemplate:i}=e;this.unRenderedRiverContent=this.unRenderedRiverContent.concat(t),this.unRenderedLayoutTemplate.push(i)}return this.renderHelper.recordAndUpdateRequestBatch(a.length),this.updateNativeAdRegion(n),!0}))}isEmpty(){return 0===this.unRenderedLayoutTemplate.length}shouldPrefetch(){const e=this.config.numOfSectionsToPrefetch||2;return this.unRenderedLayoutTemplate.length<=e&&!this.prefetchHandler&&this.initFirstDone&&this.readyForPrefetch}noPreviousResp(){return!this.previousRiverSectionContentResponse}prefetchOnlyFirstTime(){return Object(A.a)(this,void 0,void 0,(function*(){try{this.fetchAndHandleSamAds(!0)}catch(e){}if(this.disablePrefetchHack)return void(this.initFirstDone=!0);(yield this.getContentForNextFeed(tt.b.subsequent))&&(this.fetchAndHandleSamAds(!0),this.fetchAndHandleCmsAds(),this.isGetContentForNextFeedBlocked&&(this.renderNextFeed(tt.b.subsequent),this.isGetContentForNextFeedBlocked=!1)),this.initFirstDone=!0}))}resetParameters(){ut&&ut.clearCache(),this.previousRiverSectionContentResponse=null,this.unRenderedLayoutTemplate=[],this.unRenderedRiverContent=[],this.renderHelper.reset(),this.isFirstFeedCall=!0,this.refreshNativeAdSections(),this.resetRowCount()}revalidateExperienceStaleState(){var e;let t=36e5;const i=null===(e=this.config.stalenessInfo)||void 0===e?void 0:e.staleThreshold;return i&&i<1&&(t=60*i*1e3),Object(le.j)(pe.e)>t?(this.refreshFeed(),this.pageRevealRevalidatePromise=new mt.a,this.pageRevealRevalidatePromise.getResultAsync()):(this.refreshSDCard(),Promise.resolve(void 0))}getExperienceType(){return d.a.desktopFeedEdgeNextWC}riverPaginationCallback(e){var t;if(!e||!e.length)return;(null!==(t=e[1])&&void 0!==t?t:e[0]).isIntersecting?(this.isSentinelInView=!0,this.updateFeed()):this.isSentinelInView=!1}riverPlaceholderLowerCallback(e){var t;return Object(A.a)(this,void 0,void 0,(function*(){if(!e||!e.length)return;if((null!==(t=e[1])&&void 0!==t?t:e[0]).isIntersecting){if(this.isPlaceholderLowerSentinelInView=!0,!this.isPlaceholderUpperSentinelInView&&this.renderedRiverPlaceholderCount>0)return;yield Object(xt.a)(),this.updatePlaceholder()}else this.isPlaceholderLowerSentinelInView=!1}))}riverPlaceholderUpperCallback(e){var t;if(!e||!e.length)return;(null!==(t=e[1])&&void 0!==t?t:e[0]).isIntersecting?this.isPlaceholderUpperSentinelInView=!0:this.isPlaceholderUpperSentinelInView=!1}mapFeedData(e,t,i,n,a){const s={cards:[],C5:[],C4:[],C3:[],C2:[],C1:[]};if(!e.length)return s;const r=I.a[t],{cardSlots:o}=r;if(i>=0)if(0===i)this.rowCountList[0]={C1:0,C2:0,C3:0,C4:0,C5:0};else if(!("C1"in this.rowCountList[i])){const e=this.rowCountList[i-1],t=I.a[this.layoutTemplateList[i-1]],{rowHeightPx:n}=t;this.rowCountList[i]={C5:e.C5+(n&&n.C5&&n.C5.length?n.C5.length/2:0),C4:e.C4+(n&&n.C4&&n.C4.length?n.C4.length/2:0),C3:e.C3+(n&&n.C3&&n.C3.length?n.C3.length/2:0),C2:e.C2+(n&&n.C2&&n.C2.length?n.C2.length/2:0),C1:e.C1+(n&&n.C1&&n.C1.length?n.C1.length/2:0)}}return e.map(e=>[M.a[e.type],e]).filter(e=>Boolean(e[0])).map(([e,t])=>e===T.b.serendipityCard?[T.b.trendingNowCard,t]:[e,t]).map(([e,s],r)=>{var c;return null===(c=T.a[e])||void 0===c?void 0:c.getFeedDataForCard(this.createArgs(e,{cardMetadata:s,parentTelemetryObject:a,cardSlot:o[r],layoutTemplateName:t,openLinksInNewTab:n},r,i))}).filter(e=>Boolean(e)).flatMap(e=>Object.entries(e)).reduce((e,[t,i=[]])=>{const n=e[t];return n?Object.assign(Object.assign({},e),{[t]:n.concat(...i)}):e},s)}getOverrideStyles(e){const{config:t}=this,i=e.reduce((e,i)=>{const n=i(t)||{};return Object.assign(Object.assign({},e),n)},{});return Object.entries(i).map(([e,t])=>`${e}:${t};`).join("")}addPageConfiguration(e){const t=Object(E.c)(k.a.ChromiumPageSettings);if(!t)return;const i=t.getCurrentState();if(!i)return;"peek"===i.selectedFeedDisplaySetting?this.rowCountForTTVR=1:this.rowCountForTTVR=2;let n=!1;"function"==typeof t.getPrimaryAccountInfoAsync&&t.getPrimaryAccountInfoAsync().then(e=>{n=e.accountType===ae.d.MSA});const a=Et.a.getPageConfiguration(i,n);a&&!isNaN(a)&&(e.initialRequest.pageConfiguration=a)}getRenderedSDCardKeys(){const e=[],t=Object.keys(Le());return this.riverSectionFeedLayoutData.slice(0,2).forEach(i=>{var n;null===(n=i.cardMetadataList)||void 0===n||n.forEach(Ue,{keys:t,result:e})}),e}getUnRenderedSDCardKeys(){const e=[],t=Object.keys(Le());return this.unRenderedRiverContent.forEach(Ue,{result:e,keys:t}),e}updateUnRenderedSDCard(e){this.unRenderedRiverContent.forEach((t,i,n)=>{var a;const s=t.type,r=null===(a=e[Le()[s]])||void 0===a?void 0:a.find(e=>e.type===s);r&&(n[i]=r)})}updateSDCard(e){const t=this.riverSectionFeedLayoutData.slice(0,2),i=[];t.forEach((t,n)=>{const{cardMetadataList:a,templateId:s}=t;if(!a)return;e&&a.forEach(We,{response:e});const r=Object.assign(Object.assign({},t),{feedData:this.mapFeedData(a,s,n,!0,this.riverSectionTelemetryObject),cardMetadataList:a});i.push(r)}),this.riverSectionFeedLayoutData=[...i,...this.riverSectionFeedLayoutData.slice(2)]}refreshNativeAdSections(){this.nativeAdFetcher.refreshNativeAdFetcher(this.config),this.unServedSamAdSet.clear(),this.waitingAdsMap.clear(),this.infoPaneNativeAdsMap=[],this.riverNativeAdsMap=[],this.tabInfoPaneNativeAdsMap=[],this.cmsInfopaneNativeAdsMap=[],this.cmsRiverNativeAdsMap=[],this.layoutTemplateList=[],this.rowCountList=[]}updateNativeAdRegion(e){this.nativeAdFetcher.updateNativeAdFetcherRegionIndexList(e)}addWaitingIndex(e){const t=this.waitingAdsMap;t.has(e)||t.set(e,!0)}fireServedTrackingCallForPlacements(e,t){const i=this.beaconService.fireAdServedTrackingCall.bind(this.beaconService),{samAdNextPageUpperBound:n}=this.config,a=t&&void 0!==n?(e=>(t,n)=>{n<e?i(t):this.unServedSamAdSet.add(t)})(n):i;e.map(({beaconsJson:e,bingTrackerUrls:t=[],videoViewabilityData:i})=>!e||t.length>0&&i?null:e).filter(e=>Boolean(e)).forEach(a)}updateNativeAdInRiverSections(){if(!(this.infoPaneNativeAdsMap.length>0||this.riverNativeAdsMap.length>0||this.cmsInfopaneNativeAdsMap.length>0||this.cmsRiverNativeAdsMap.length>0||this.tabInfoPaneNativeAdsMap.length>0))return;const{riverSectionFeedLayoutData:e}=this;if(!e||!e.length)return;const t=e.map((e,t)=>{if(!this.waitingAdsMap.get(t))return e;const{cardMetadataList:i=[]}=e;let n=!1;const a=(e,t)=>{const i=this.createNativeAdCardMetadata(t,e.regionIndex);return Ge(e)&&(n=!0),i},s=(e,t)=>Object.assign(Object.assign({},e),{subItems:e.subItems.map(t)}),r=i.map(e=>Y(e)?s(e,e=>Z(e)&&Ge(e)?a(e,"infopane"):ee(e)&&Ge(e)?a(e,"infopane_cms"):e.type===F.a.Dense?s(e,e=>Z(e)&&Ge(e)?a(e,"infopane-tab"):e):e):Z(e)&&Ge(e)?a(e,"river"):ee(e)&&Ge(e)?a(e,"river_cms"):e);return n||this.waitingAdsMap.set(t,!1),{feedData:this.mapFeedData(r,e.templateId,t,!0,this.riverSectionTelemetryObject),templateId:e.templateId,cardMetadataList:r}});this.riverSectionFeedLayoutData=t,window.requestAnimationFrame(()=>{const e=!0===St.b.IsPrerender?performance.now()-Object(le.j)(pe.e):performance.now();Object(le.q)(oe.a.TimeToRenderAd,e)});const i=!0===St.b.IsPrerender?performance.now()-Object(le.j)(pe.e):performance.now();Object(le.q)(oe.a.RenderReady,i)}get nativeAdConfig(){return Object.assign({adLabelText:this.adLabelText,isGreyAdsLabelEnabled:this.isGreyAdsLabelEnabled},this.config)}updateCmsNativeAdMap(e){const t=Ve(this.nativeAdConfig,e);if(!t)return;const{infopane_cms:i=[],river_cms:n=[]}=t;this.cmsInfopaneNativeAdsMap=this.cmsInfopaneNativeAdsMap.concat(i),this.cmsRiverNativeAdsMap=this.cmsRiverNativeAdsMap.concat(n)}createNativeAdCardMetadata(e,t){const{placement:i,type:n}=this.calcPlacementByRegionType(e,t);if(i){const{beaconsJson:a}=i;return a&&this.unServedSamAdSet.delete(a)&&this.beaconService.fireAdServedTrackingCall(a),{type:n,regionIndex:t,id:`nativead-${e}-${i.regionIndex}`,placement:i}}return{type:n,regionIndex:t,placement:{items:[]}}}calcPlacementByRegionType(e,t){let i,n=F.a.NativeAd;const a=e=>e.regionIndex===t;switch(e){case"infopane":i=this.infoPaneNativeAdsMap.find(a);break;case"river":i=this.riverNativeAdsMap.find(a);break;case"infopane-tab":i=this.tabInfoPaneNativeAdsMap.find(a);break;case"infopane_cms":i=(this.config.enableInfopaneLeadgenNative?this.infoPaneNativeAdsMap:this.cmsInfopaneNativeAdsMap).find(a),n=F.a.CmsAd;break;case"river_cms":i=(this.config.enableRiverLeadgenNative?this.riverNativeAdsMap:this.cmsRiverNativeAdsMap).find(a),n=F.a.CmsAd}return{placement:i,type:n}}fallbackToRiverSentinel(){if(!this.config.enableGreyBlock)return;this.clearPaginationObserver(),this.riverPlaceholderData=[],this.renderedRiverPlaceholderCount=0,this.isPlaceholderUpperSentinelInView=!1,this.isPlaceholderLowerSentinelInView=!1;const e=[[this.riverSentinel,this.riverPaginationCallback.bind(this)]];this.setupPaginationObserver(e)}sectionVisiblityCallback(e){var t;for(let i=0;i<e.length;i++){const n=e[i];n.isIntersecting&&!(null===(t=this.scrollRenderMetadataMap.get(n.target))||void 0===t?void 0:t.st)&&this.scrollRenderMetadataMap.set(n.target,Object.assign(Object.assign({},this.scrollRenderMetadataMap.get(n.target)),{st:window.performance.now()}))}}scheduleAndSendScrollMetrics(){const e=[];this.scrollRenderMetadataMap.forEach(t=>{t.et&&e.push(t)}),H.a.addOrUpdateTmplString("scrollMetrics:"+encodeURIComponent(JSON.stringify(e)))}selectAllSections(){var e;return null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelectorAll(".msft-feed-layout-wrapper")}markScrollRenderEndTime(e){const t=this.selectAllSections()[e];t&&this.scrollRenderMetadataMap.set(t,Object.assign(Object.assign({},this.scrollRenderMetadataMap.get(t)),{et:window.performance.now()}))}resetRowCount(){this.layoutTemplateList=[],this.rowCountList=[]}}Object(A.d)([jt.d],$t.prototype,"sdCardMenuOpen",void 0),Object(A.d)([jt.d],$t.prototype,"sdCardMenuProps",void 0),Object(A.d)([jt.d],$t.prototype,"layout",void 0),Object(A.d)([jt.d],$t.prototype,"riverSectionTelemetryObject",void 0),Object(A.d)([jt.d],$t.prototype,"riverSectionFeedLayoutData",void 0),Object(A.d)([jt.d],$t.prototype,"riverPlaceholderData",void 0),Object(A.d)([jt.d],$t.prototype,"renderedRiverCount",void 0),Object(A.d)([jt.d],$t.prototype,"renderedRiverPlaceholderCount",void 0),Object(A.d)([jt.d],$t.prototype,"overrideWillChangeStyles",void 0),Object(A.d)([jt.d],$t.prototype,"overrideGapStyles",void 0),Object(A.d)([jt.d],$t.prototype,"coldStartFreResponse",void 0),Object(A.d)([Object(At.b)({mode:"boolean"})],$t.prototype,"hasRightRail",void 0);var qt=i("eUhr"),Vt=i("6BDD"),Gt=i("+53S"),zt=i("6vBc"),Qt=i("UNqU"),_t=i("3cVL"),Jt=i("Nt9a"),Kt=i("LelC");kt.a;const Xt=Vt.b`
    ${e=>Object(_t.a)(e.config.childExperienceReferencesWC.toastWC)}
`,Yt=Vt.b`
    ${e=>Object(_t.a)(e.config.childExperienceReferencesWC.pillWC,{properties:{refreshCallback:()=>e.callRefreshFeed(),getDesktopFeedRect:()=>e.getBoundingClientRect()}})}
`,Zt=Vt.b`
<msn-actions-menu
    :menuItems=${e=>{var t;return null===(t=e.sdCardMenuProps)||void 0===t?void 0:t.menuItems}}   
    :referrerButton=${e=>{var t;return null===(t=e.sdCardMenuProps)||void 0===t?void 0:t.referrerButton}}
    :useFastAnchoredRegion=${e=>!1}
    ${Object(Gt.b)("sdCardMenuRef")}
>
</msn-actions-menu>
`,ei=Vt.b`
    <div ${Object(Gt.b)("coldStartContainerElement")}>
        ${Object(zt.a)(e=>e.coldStartFreResponse,Vt.b`
            ${e=>Object(_t.a)(e.config.childExperienceReferencesWC.coldStartModal,{properties:{coldStartArtifact:e.coldStartFreResponse,parentContainerElement:e.coldStartContainerElement}})}
        `)}
    </div>
`,ti=Vt.b`
    ${Object(Qt.c)(e=>e.riverSectionFeedLayoutData,Vt.b`
        <msft-feed-layout
            style="${(e,t)=>{var i;return t.parent.overrideGapStyles+t.parent.getOverrideGridStyles(null===(i=e.cardMetadataList)||void 0===i?void 0:i[0].type)}}"
            layout="${(e,t)=>t.parent.layout}"
            :data="${e=>e.feedData}"
            :cardTemplateMap="${()=>Jt.a}"
            :layoutStyles="${e=>I.a[e.templateId].styles}"
            class="msft-feed-layout-wrapper"
            >
        </msft-feed-layout>
    `)}
`,ii=Vt.b`
    <div style="${e=>"display: grid;"+e.overrideGapStyles+Object(Kt.a)(e.config.zoomRatio)}">
    ${ti}
    </div>
`,ni=Vt.b`
    <div role="main" class="desktop-feed-edgenext-root" ${Object(qt.b)(e=>{var t;return null===(t=e.telemetryObject)||void 0===t?void 0:t.getMetadataTag()})} style="${e=>e.config.zoomRatio&&e.config.zoomRatio<1?Object(Kt.a)(e.config.zoomRatio):""}">
        ${Object(zt.a)(e=>{var t;return null===(t=e.config.childExperienceReferencesWC)||void 0===t?void 0:t.pillWC},Yt)}
        <div class="infopane-sentinel"></div>
        <div class="feed" style="${e=>e.overrideGapStyles+e.overrideWillChangeStyles}" ${Object(qt.b)(e=>e.riverSectionTelemetryObject.getMetadataTag())}>
            ${Object(zt.a)(e=>e.config.zoomRatio&&e.config.zoomRatio>1,Vt.b`
                ${ii}
            `)}
            ${Object(zt.a)(e=>!e.config.zoomRatio||e.config.zoomRatio<1,Vt.b`
                ${ti}
            `)}
            <div ${Object(Gt.b)("riverSentinel")} id="river-sentinel" class="${e=>e.config.enableGreyBlock?"river-sentinel-grey-block":"river-sentinel"}"></div>
            ${Object(zt.a)(e=>e.config.enableGreyBlock,Vt.b`
                <div id="river-placeholder-upper-sentinel" class="river-placeholder-sentinel" ${Object(Gt.b)("riverPlaceHolderUpperSentinel")} ></div>
                ${Object(Qt.c)(e=>e.riverPlaceholderData,Vt.b`
                    <msft-feed-layout
                        style="${(e,t)=>{var i;return t.parent.overrideGapStyles+t.parent.getOverrideGridStyles(null===(i=e.cardMetadataList)||void 0===i?void 0:i[0].type)}}"
                        layout="${(e,t)=>t.parent.layout}"
                        :data="${e=>e.feedData}"
                        :cardTemplateMap="${()=>Jt.a}"
                        :layoutStyles="${e=>I.a[e.templateId].styles}"
                        >
                    </msft-feed-layout>
                `)}
                <div id="river-placeholder-lower-sentinel" class="river-placeholder-sentinel" ${Object(Gt.b)("riverPlaceHolderLowerSentinel")}></div>
            `)}
        </div>
    </div>
    ${Object(zt.a)(e=>{var t;return null===(t=e.config.childExperienceReferencesWC)||void 0===t?void 0:t.toastWC},Xt)}
    ${Object(zt.a)(e=>e.sdCardMenuOpen,Zt)}
    ${ei}
`;var ai=i("kL0l");const si=i("4X57").a`

.desktop-feed-edgenext-root {
    color: ${ai.G.var};
    margin: 0 auto;
    position: relative;
}

.infopane-sentinel {
    position: absolute;
    width: 612px;
    height: 304px;
    top: 0;
    left: 0;
    z-index: -1;
}

.feed {
    display: grid;
    flex-flow: row wrap;
    gap: 12px;
    justify-content: center;
    margin-bottom: 33px;
    --elevated-corner-radius: 6;
}

.river-sentinel {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: -1;
}

.river-sentinel-grey-block, .river-placeholder-sentinel {
    width: 100%;
    z-index: -1;
}

`.withBehaviors(ai.k,ai.G),ri={experienceConfigSchema:S}},S8sE:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("D57K");i("roS3"),i("r6MD");setTimeout;let a=setTimeout;function s(e){return Object(n.a)(this,void 0,void 0,(function*(){return new Promise((t,i)=>{a(t,e)})}))}function r(e=1){return Object(n.a)(this,void 0,void 0,(function*(){for(let t=0;t<e;t++)yield s(0)}))}},SHdd:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n,a;!function(e){e.AppAnonCookie="appanoncookie",e.MyFeed="myfeed",e.AuthToken="AuthToken",e.UpdateMyFeed="updatemyfeed",e.RefreshConfigs="refreshconfigs",e.DetectConfigChanges="detectconfigchanges",e.ClearConfigCache="clearconfigcache",e.Updatepdp="updatepdp",e.WeatherPdp="weatherpdp",e.MoneyPdp="moneypdp",e.LocalNews="localnews",e.SportsTeamPdp="sportsteampdp",e.SportsPlayerPdp="sportsplayerpdp",e.SportsLeaguePdp="sportsleaguepdp",e.PerfMarkers="perfmarkers",e.ContentPreviewData="ContentPreviewData",e.ContentPreviewCache="ContentPreviewCache",e.PostTtvr="PostTtvr",e.FeedDisplaySetting="FeedDisplaySetting",e.WebWorkerError="WebWorkerError",e.InvalidateWeatherPdp="InvalidateWeatherPdp",e.InvalidateMoneyPdp="InvalidateMoneyPdp",e.StripeMyFeed="StripeMyFeed",e.UpdateMyBriefing="UpdateMyBriefing",e.MyBriefing="MyBriefing",e.WindowsFeed="WindowsFeed",e.IndustryNewsArticles="IndustryNewsArticles",e.AuctionPrefetch="AuctionPrefetch",e.AuctionAPIDuration="AuctionAPIDuration"}(n||(n={})),function(e){e[e.Fetching=1]="Fetching",e[e.Fetched=2]="Fetched"}(a||(a={}))},XAMW:function(e,t,i){"use strict";t.a=function(e,t,i){var n;return i(e,(function(e,i,a){if(t(e,i,a))return n=i,!1})),n}},btVS:function(e,t,i){"use strict";t.a=function(e,t,i,n,a){return a(e,(function(e,a,s){i=n?(n=!1,e):t(i,e,a,s)})),i}},cASJ:function(e,t,i){"use strict";i.d(t,"a",(function(){return ke})),i.d(t,"b",(function(){return Fe}));var n,a=i("D57K"),s=i("XlyT"),r=i("HxRh"),o=i("+djJ"),c=i("YUMq"),d=i("pMIE"),l=i("2H+z"),h=i("r6MD"),u=i("KPQt"),p=i("CjK2"),v=i("oIHq"),g=i("rvYQ"),f=i("ADRF"),b=i("aHCm"),m=i("lifk"),C=i("iQkd");!function(e){e.SlideshowPreview="ss",e.ArticlePreview="ar",e.VideoPreview="vi"}(n||(n={}));var O=i("KETb"),y=i("u5KZ");class S{getCMSList(e,t){return Object(a.a)(this,void 0,void 0,(function*(){if(e)try{const i={method:"GET",headers:{}},n=yield Object(O.b)(()=>Object(a.a)(this,void 0,void 0,(function*(){const t=new URL(`${C.e.CMSListServiceUrl}${e}${g.a.ContentServiceUrlBase.search}`,""+g.a.ContentServiceUrlBase),n=yield fetch(t.toString(),i);if(n.ok)return n.json();y.a.sendAppErrorEvent(Object(s.a)(r.Ee,"Get CMSAd content failed",`Invalid response from CMS, ${n.statusText}, listId: ${e}`))})),"getCMSList");if(!n)return void y.a.sendAppErrorEvent(Object(s.a)(r.Ee,"Get CMSAd content failed","Invalid response.json(), listId: "+e));const o=n;return this.translateToCMSItem(o,e,t,C.b.PrivacyUrl)}catch(t){return void y.a.sendAppErrorEvent(Object(s.a)(r.Ee,"Get CMSAd content failed",`Error while fetching CMS Native Ad  ${t}, id: ${e}`))}else y.a.sendAppErrorEvent(Object(s.a)(r.Ee,"Get CMSAd content failed","No backfill id found, listId: "+e))}))}translateToCMSItem(e,t,i,n){return Object(a.a)(this,void 0,void 0,(function*(){if(!e||!e.list||0===e.list.length)return void y.a.sendAppErrorEvent(Object(s.a)(r.Ee,"Get CMSAd content failed","No CMS Response returned from "+t));const a=[];for(const t of e.list){let e=!1;const s=t.extendedProperties;if(s)for(const t of s)if(t.key&&t.key.indexOf("is_content")>-1&&t.values&&t.values.indexOf("true")>-1){e=!0;break}let r;if(null!=t.link&&null!=t.link.title&&t.link.href&&null!=t.link.image&&null!=t.link.image.href){const i=this.getCMSContentId(t.link.image.href);let a,s;if(t.link.ad)if(t.link.ad.providerHref&&t.link.ad.providerHref.href){const e=this.getCMSContentId(t.link.ad.providerHref.href);e?a=yield this.fetchProviderName(e):t.link.ad.sponsorText&&(a=t.link.ad.sponsorText)}else t.link.ad.sponsorText&&(a=t.link.ad.sponsorText);s=a||(null!=t.link.kicker?t.link.kicker:C.e.DefaultProviderName),r={title:t.link.title,url:t.link.href,provider:{name:s},imageUrl:i?Object(m.h)(i,{width:624,height:350,enableDpiScaling:!1}):t.link.image.href,isContent:e,privacyUrl:n}}else if(null!=t.reference&&null!=t.reference.href){const a=this.getCMSContentId(t.reference.href);if(null!=a){const t=yield this.getCMSContent(a);if(!t)continue;r={title:t.title,url:this.constructDestinationUrl(t,i),provider:this.constructProvider(t),imageUrl:this.constructImageUrl(t),isContent:e,privacyUrl:n}}}r&&r.title&&r.imageUrl&&r.url&&a.push(r)}return{id:e._id,items:a}}))}getCMSContent(e){return Object(a.a)(this,void 0,void 0,(function*(){try{const t=new URL(g.a.ContentServiceUrlBase.search,`${g.a.ContentServiceUrlBase}${C.e.CMSContentServiceURl}${e}/`),i=yield fetch(t.toString());if(!i||!i.ok)return void y.a.sendAppErrorEvent(Object(s.a)(r.Ee,"Get CMSAd content failed","Failed to fetch CMS content, cmsId: "+e));const n=yield i.json();return n||void y.a.sendAppErrorEvent(Object(s.a)(r.Ee,"Get CMSAd content failed","Invalid JSON response to get CMS content, cmsId: "+e))}catch(t){return void y.a.sendAppErrorEvent(Object(s.a)(r.Ee,"Get CMSAd content failed",`Error while fetching CMS content ${t}, cmsId: ${e}`))}}))}constructDestinationUrl(e,t){const{category:i}=e,a=i&&i.product||"news",s=i&&i.label||"other",r=n[e.type]||"xx";return`https://www.msn.com/${t}/${f.a.encodeURIComponentForPrime(a||"")}/${f.a.encodeURIComponentForPrime(s||"")}/${f.a.encodeURIComponentForPrime(e.title||"")}/${r}-${e.id}`}constructProvider(e){const{name:t,logo:i}=e.provider;return{name:t,logo:i&&i.id?{src:`${b.a.prod}${i.id}?w=16&h=16`,alt:t}:void 0}}constructImageUrl(e){if(e.images&&!(e.images.length<1)&&e.images[0].id)return Object(m.h)(e.images[0].id,{width:624,height:350,focalRegion:e.images[0].focalRegion,enableDpiScaling:!1})}getCMSContentId(e){return e&&e.indexOf("cms/api/amp")>-1?e.substring(e.lastIndexOf("/")+1):null}fetchProviderName(e){return Object(a.a)(this,void 0,void 0,(function*(){try{const t={method:"GET",headers:{}},i=yield Object(O.b)(()=>Object(a.a)(this,void 0,void 0,(function*(){const i=new URL(`${C.e.CMSListServiceUrl}${e}${g.a.ContentServiceUrlBase.search}`,""+g.a.ContentServiceUrlBase),n=yield fetch(i.toString(),t);if(n.ok)return n.json();y.a.sendAppErrorEvent(Object(s.a)(r.Ee,"Get CMSAd content failed",`Invalid response from CMS. status: ${n.status}, statusText: ${n.statusText}, url: ${n.url}`))})),"getProviderName");if(!i)return void y.a.sendAppErrorEvent(Object(s.a)(r.Ee,"Get CMSAd content failed","Invalid response.json(), cmsId: "+e));const n=i;return n?n.displayName:void y.a.sendAppErrorEvent(Object(s.a)(r.Ee,"Get CMSAd content failed","Failed to parse JSON response, cmsId: "+e))}catch(t){return void y.a.sendAppErrorEvent(Object(s.a)(r.Ee,"Get CMSAd content failed",`Error while fetching Provider name  ${t}, cmsId: ${e}`))}}))}}var j=i("Bwzq");const A={rating:3,likes:4,price:6,salePrice:7,installmentPrice:500,priceDrop:501,freeShipping:502,viewed:503,sold:504,specialOffer:505,eliteBadge:506,condition:507,localInventory:508,curbsidePickup:509,review:510,discount:600};var w,I=i("I6Lx"),T=i("zfSW"),R=i("SHdd"),P=i("y+Kz"),M=i("5Uqz"),k=i("tWvP"),E=i("ypwz"),F=i("s9+9"),D=i("4wjP");!function(e){e.AR="AR",e.GA="GA",e.VI="VI",e.EDGECHRNTP="edgechrntp",e.EDGECHRDHP="edgechrdhp",e.MSNEWS="msnews",e.FirstParty="firstparty",e.VerticalLandingPage="vlp",e.WINVLP="winvlp",e.WINAR="winar",e.WINGA="winga",e.WINVI="winvi",e.WEBCOMPAR="webcompar",e.WEBCOMPGA="webcompga",e.WEBCOMPVI="webcompvi"}(w||(w={}));var x=i("3Amp"),N=i("lEej"),L=i("GqIT");let U,W=!1;const B=new Promise(e=>{U=e});function H(){return Object(a.a)(this,void 0,void 0,(function*(){switch(yield function(){return Object(a.a)(this,void 0,void 0,(function*(){W||(x.a.cookieConsentStatus.registerObserver(e=>{U()}),W=!0);const e=L.a.getInstance().rootReducer.connector(F.a.SharedState),t=e&&e.getCurrentState(),i=t&&t.cookieConsentStatus;return i!==N.a.Unknown?i:(yield B,e.getCurrentState().cookieConsentStatus)}))}()){case N.a.Required:return!0;case N.a.NotRequired:return!1;default:return}}))}class ${updateMsaOptOutCookie(e){if(!this.getMsaOptoutCookieData()&&e&&e.optout){const t=!0===e.optout.msaOptOut?"1":"0";this.setMsaOptoutCookie(t)}}getMsaOptoutCookieData(){const e=Object(M.a)(C.f.MSAOptOut);return e&&e.length>0?e:null}setMsaOptoutCookie(e){e&&e.length>0&&Object(k.a)(C.f.MSAOptOut,e,1,null,"/")}getBrowserOptoutStatus(){const e=Object(M.a)(C.f.BrowserOptOut);return!(!e||"1"!==e)}setUserOptOutSettings(){const e=this.getBrowserOptoutStatus(),t=this.getMsaOptoutCookieData(),i=!(!t||"1"!==t),n=(e||i).toString().toLowerCase();let a="";e&&(a="b|"),i&&(a+="m");const s=C.b.UserOptOut+":"+n+";"+C.b.UserOptOutOptions+":"+a;if(document.head.attributes["data-info"]){const e=document.head.attributes["data-info"].value.split(";");e.find(e=>e.indexOf(C.b.UserOptOut)>-1)?e.find(e=>e.indexOf(C.b.UserOptOut)>-1)!==C.b.UserOptOut+":"+n&&(document.head.attributes["data-info"].value=document.head.attributes["data-info"].value.replace(C.b.UserOptOut+":false",C.b.UserOptOut+":"+n).replace(C.b.UserOptOut+":true",C.b.UserOptOut+":"+n)):document.head.attributes["data-info"].value=document.head.attributes["data-info"].value+";"+C.b.UserOptOut+":"+n,e.find(e=>e.indexOf(C.b.UserOptOutOptions)>-1)?e.find(e=>e.indexOf(C.b.UserOptOutOptions)>-1)!==C.b.UserOptOutOptions+":"+a&&(e.includes(C.b.UserOptOutOptions+":")?document.head.attributes["data-info"].value=document.head.attributes["data-info"].value.replace(C.b.UserOptOutOptions+":",C.b.UserOptOutOptions+":"+a):e.includes(C.b.UserOptOutOptions+":b|")?document.head.attributes["data-info"].value=document.head.attributes["data-info"].value.replace(C.b.UserOptOutOptions+":b|",C.b.UserOptOutOptions+":"+a):e.includes(C.b.UserOptOutOptions+":b|m")?document.head.attributes["data-info"].value=document.head.attributes["data-info"].value.replace(C.b.UserOptOutOptions+":b|m",C.b.UserOptOutOptions+":"+a):e.includes(C.b.UserOptOutOptions+":m")&&(document.head.attributes["data-info"].value=document.head.attributes["data-info"].value.replace(C.b.UserOptOutOptions+":m",C.b.UserOptOutOptions+":"+a))):document.head.attributes["data-info"].value=document.head.attributes["data-info"].value+";"+C.b.UserOptOutOptions+":"+a}else document.head.setAttribute("data-info",s)}}var q=i("HhTf"),V=i("loKy"),G=i("w0HK"),z=i("C4R5");let Q=!0;class _{constructor(){this.riverNativeAdCount=0,this.reservedRiverNativeAdCount=0,this.dualWideRiverNativeAdCount=0,this.halfRiverNativeAdCount=0,this.beaconService=new v.a,this.cookieService=new $,this.ecasession=C.b.Ecasession;const e=L.a.getInstance().rootReducer;if(g.a.AppType===E.a.EdgeChromium){const t=e.connector(F.a.ChromiumPageSettings);t&&(this.anaheimPageLayout=t.getCurrentState().currentLayout)}const t=e.connector(F.a.SharedState);t&&t.getCurrentState().useHistory?Object(z.a)().addSwitchListener(this.onPivotSwitch.bind(this),V.a.Monetization):Object(G.a)().addSwitchListener(this.onPivotSwitch.bind(this),V.a.Monetization)}get sourceUrl(){if(this._sourceUrl)return this._sourceUrl;this._sourceUrl=g.a.HostPage.originalUrl;const e=g.a.CurrentRequestTargetScope.pageType,t=g.a.HostPage.verticalKey;if(e&&t){const i=e.toLowerCase();(i.indexOf(D.b.DHP)>-1||i.indexOf(D.b.NTP)>-1)&&(this._sourceUrl="https://"+g.a.HostPage.hostName+"/"+t+"/"+e)}return this._sourceUrl}get pageType(){if(this._pageType)return this._pageType;const e=g.a.CurrentRequestTargetScope.pageType,t=g.a.CurrentRequestTargetScope.ocid;return this._pageType=e,g.a.AppType===E.a.EdgeChromium?this._pageType=w.EDGECHRNTP:g.a.AppType===E.a.Views&&("article"===e?this._pageType=this.isWindowsViewsPage(t)?w.WINAR:w.WEBCOMPAR:"gallery"===e?this._pageType=this.isWindowsViewsPage(t)?w.WINGA:w.WEBCOMPGA:"video"===e&&(this._pageType=this.isWindowsViewsPage(t)?w.WINVI:w.WEBCOMPVI)),this._pageType}fetchSAMAds(e,t=!1){return Object(a.a)(this,void 0,void 0,(function*(){if(!e||!e.placements||e.placements.length<1)return void y.a.sendAppErrorEvent(Object(s.a)(r.He,"Invalid request to fetch native ads","No placements found in the request"));const{anaheimColLayout:i}=e,n=e.pageType||this.pageType;if(!n)return void y.a.sendAppErrorEvent(Object(s.a)(r.He,"Invalid request to fetch native ads","No page type found"));const d=this.getImpressionId(),l=this.cookieService.getBrowserOptoutStatus(),h=yield H(),u=this.getMuid(e.adid),p=this.riverNativeAdCount,v=this.reservedRiverNativeAdCount,f=this.dualWideRiverNativeAdCount,b=this.halfRiverNativeAdCount;!h&&t&&(this.ecasession=Object(M.a)(C.f.TaboolaSessionCookieName)||this.ecasession);const m=!(!I.b.ClientSettings||!I.b.ClientSettings.deviceFormFactor||I.b.ClientSettings.deviceFormFactor!==q.a.Phone),O=this.isNotMyFeed(),S={locale:e.locale,rid:d,partnerId:g.a.CurrentRequestTargetScope.pageType,content:{sourceUrl:this.sourceUrl,pageType:n,previousReservedRiverNativeAdCount:v,previousRiverDualWideNativeAdCount:f,previousRiverHalfNativeAdCount:b,previousRiverNativeAdCount:p,verticalName:g.a.HostPage.verticalKey,anaheimPageLayout:this.anaheimPageLayout,anaheimColLayout:i,isXfeed:O,audienceMode:g.a&&g.a.CurrentRequestTargetScope&&g.a.CurrentRequestTargetScope.audienceMode},user:{muid:u,browserOptOut:l,isAdblock:!1},placements:this.getPlacements(e,n),extensions:this.getExtensions(this.lastResponseMetadata,this.ecasession),isCookieWallPresent:h,isPeregrine:!0,device:{isMobile:m}},A=JSON.stringify(S),k=e.enableAuctionInWebWorker&&Q&&!O&&!I.b.IsPrerender,E=new URL(C.b.SamEndpoint+(k?"?init=1":""));return new Promise(e=>{try{if(k){const t=Object(T.a)(R.a.AuctionPrefetch),i=t&&t.payload;if(i)return void e(this.processAdResponse(i))}const t=new XMLHttpRequest;t.open(C.j.Method,E.href,!0),t.withCredentials=!0,t.timeout=C.j.Timeout,t.setRequestHeader(C.j.ContentTypeKey,C.j.ContentType),t.setRequestHeader(C.j.FlightIdKey,I.b.CurrentFlights),t.setRequestHeader(C.j.CacheControlKey,C.j.CacheControl),u&&t.setRequestHeader(C.j.ClientIdKey,u),n===w.GA?t.setRequestHeader(C.j.AuthCookieNameKey,C.f.AnonCookieName):Object(M.a)(C.f.AppAnonCookieExist)&&t.setRequestHeader(C.j.AuthCookieNameKey,P.e),t.onload=()=>{var i,n;i=E.href,n=k,Object(a.a)(void 0,void 0,void 0,(function*(){var e;const t=performance.getEntriesByName&&performance.getEntriesByName(i)&&(null===(e=performance.getEntriesByName(i)[0])||void 0===e?void 0:e.duration),a=n?yield Object(T.b)({id:R.a.AuctionAPIDuration},500,!1).then(({payload:e})=>e):0;a&&t?Object(o.q)(j.a.ApiDuration,a<t?t:a):t?Object(o.q)(j.a.ApiDuration,t):a&&Object(o.q)(j.a.ApiDuration,a)})),e(this.processAdResponse(t))},t.ontimeout=()=>{y.a.sendAppErrorEvent(Object(s.a)(r.Je,"Timeout calling SAMRTB Ajax",`pageType: ${n}, status: ${t.status}, StatusText: ${t.statusText}`)),e(void 0)},t.onerror=()=>{y.a.sendAppErrorEvent(Object(s.a)(r.Ie,"Error calling SAMRTB Ajax",`pageType: ${n}, status: ${t.status}, StatusText: ${t.statusText}`)),e(void 0)},t.send(A);const i=!0===I.b.IsPrerender?performance.now()-Object(o.j)(c.e):performance.now();Object(o.q)(j.a.TimeToRequestAd,i)}catch(t){Object(s.c)(t,r.Ke,"Failed to get response from SAMRTB call","pageType: "+n),e(void 0)}finally{Q=!1}})}))}generateSourceUrl(){const e=g.a.CurrentRequestTargetScope.pageType;let t=g.a.HostPage.originalUrl;const i=g.a.HostPage.verticalKey;if(e&&i){const n=e.toLowerCase();(n.indexOf(D.b.DHP)>-1||n.indexOf(D.b.NTP)>-1)&&(t="https://"+g.a.HostPage.hostName+"/"+i+"/"+e)}return t}processAdResponse(e){if(200!==e.status)return 204===e.status?void y.a.sendAppErrorEvent(Object(s.a)(r.Je,"No content received from SAMRTB Ajax",`Status: ${e.status}, StatusText: ${e.statusText}`)):void y.a.sendAppErrorEvent(Object(s.a)(r.Ie,"Invalid response from SAMRTB Ajax",`Status: ${e.status}, StatusText: ${e.statusText}`));try{const t=JSON.parse(e.response);if(!t)return void y.a.sendAppErrorEvent(Object(s.a)(r.Le,"Invalid json response from SAMRTB",`Status: ${e.status}, Invalid json: ${e.response}`));const i=t.metaData;return this.processMetaData(i),this.beaconService.fireRequestLevelBeacons(i.requestLevelBeaconUrls),t}catch(t){return void Object(s.c)(t,r.Ke,"Failed to process SAMRTB response",`Status: ${e.status}, json: ${e.response}`)}}getPlacements(e,t){const i=[];return e.placements.forEach(e=>{if(e.region&&e.indices&&e.indices.length){const{indices:n,img:a}=e,s=t==w.EDGECHRNTP&&C.h[e.region]||e.region,r=a?{region:s,indices:n,img:a}:{region:s,indices:n};i.push(r);const o=e.region.toLocaleLowerCase();o===C.b.RiverRegion?this.riverNativeAdCount+=e.indices.length:o===C.b.ReservedRiver?this.reservedRiverNativeAdCount+=e.indices.length:o===C.b.RiverDoubleWide?this.dualWideRiverNativeAdCount+=e.indices.length:o!==C.b.RiverHalf&&o!==C.b.RiverHalfTextOnly||(this.halfRiverNativeAdCount+=e.indices.length)}}),i}processMetaData(e){const t=e&&e.taboola&&e.taboola.sessionId;!this.isCookieWallPresent&&t&&Object(k.a)(C.f.TaboolaSessionCookieName,t,.042,C.f.CookieDomain,"/"),this.lastResponseMetadata=this.mergeMetadata(this.lastResponseMetadata,e),this.cookieService.updateMsaOptOutCookie(e)}mergeMetadata(e,t){return e?t?(t.taboola=this.mergePartnerMetadata(e.taboola,t.taboola),t):e:t}mergePartnerMetadata(e,t){return t=t||{},e&&e.sessionId&&!t.sessionId&&(t.sessionId=e.sessionId),t}getImpressionId(){return this.lastResponseMetadata&&this.lastResponseMetadata.pageViewId?this.lastResponseMetadata.pageViewId:y.a.getRequestId()}clearPreviousInfo(){var e;this.riverNativeAdCount=0,this.reservedRiverNativeAdCount=0,this.dualWideRiverNativeAdCount=0,this.halfRiverNativeAdCount=0,(null===(e=this.lastResponseMetadata)||void 0===e?void 0:e.pageViewId)&&delete this.lastResponseMetadata.pageViewId}getExtensions(e,t){const i={taboola:(e=e||{taboola:{}}).taboola};return i.taboola.sessionId||(i.taboola.sessionId=t),i}getMuid(e){return this.isCookieWallPresent?null:e||Object(M.b)()}onPivotSwitch(e){if(!e.oldSelection)return;const t=e.newSelection.pivotId;t&&t.toLowerCase()!==C.i.EditInterestPivotId&&(this.pivotId=t)}isNotMyFeed(){return!!this.pivotId&&this.pivotId.toLowerCase()!==C.i.MyFeedPivotId&&this.pivotId.toLowerCase()!==C.i.StripeMyFeedPivotId}isWindowsViewsPage(e){return!!e&&("windirect"===(e=e.toLowerCase())||e.startsWith("winp"))}}var J,K=i("Crvi"),X=i("Tc2z"),Y=i("hV4J"),Z=i("hqLi"),ee=i("SEb4"),te=i("mEtE"),ie=i("uEVT"),ne=i("072S"),ae=i("3noN");!function(e){e.river="river",e.infopane="infopane",e.resriver="resriver",e.resinfopane="resinfopane"}(J||(J={}));const se=20,re=10,oe=5;var ce=i("fT6L");const de=(e,t,i)=>({modifier:(e,t)=>{t.template.useClickInGamify=i},configType:e,region:[J.river],adCount:1,template:K.a.Gamification,discountThreshold:t,requiredAssetsAll:[6,7],supportedAssets:[6,7,600],dynamicRenderingConfig:()=>ce.a}),le=de("prg-wpo-gamify-c",oe,!0),he=de("prg-wpo-gamify-h",oe,!1);var ue=i("Z4UQ");const pe=(e,t)=>({configType:e,region:[J.river],requiredAssetsAll:[6,7],adCount:1,template:K.a.HotspotSingle,supportedAssets:[6,7,600],discountThreshold:t,dynamicRenderingConfig:()=>ue.a}),ve=pe("prg-wpo-hs",se),ge=pe("prg-wpo-hs10",re),fe={configType:"default",region:[J.infopane],adCount:1,template:K.a.Default,supportedAssets:[3,502,510]},be={configType:"default",region:[J.river],adCount:1,template:K.a.Default,supportedAssets:[3,502,510]},me={configType:"default",region:[J.infopane],adCount:2,template:K.a.Default,supportedAssets:[3,502,510]};var Ce=i("pER4");const Oe=[le,he,ve,ge,fe,be,me,{configType:"prg-wpo-deco-dr",region:[J.river,J.infopane],adCount:1,template:K.a.DecorationDynamic,requiredAssetsAny:[3,502,510],supportedAssets:[3,502,510],dynamicRenderingConfig:()=>Ce.a},{configType:"prg-wpo-ss",region:[J.river],adCount:1,template:K.a.Slideshow,modifier:(e,t)=>{t.slideshowProps=t.template.slideshowProps={autoScroll:!0,autoScrollIntervalMs:3e3,maxImageCount:5,enableSlideshowMediaControls:!0}},multiImage:!0},{configType:"prg-title-2",region:[J.river],adCount:1,template:K.a.TitleMaxLine2,dynamicRenderingConfig:()=>Ce.a}],ye={[J.river]:[be],[J.infopane]:[fe]},Se=[(e,t)=>t.template.configType===e.configType,(e,t)=>e.region.includes(t.region),(e,t)=>!e.requiredAssetsAll||e.requiredAssetsAll.every(e=>Object.keys(t.items[0].assets).some(t=>e===A[t])),(e,t)=>!e.requiredAssetsAny||e.requiredAssetsAny.some(e=>Object.keys(t.items[0].assets).some(t=>e===A[t])),(e,t)=>t.items.length===e.adCount,(e,t)=>!e.discountThreshold||e.discountThreshold<=t.items[0].assets.discount,(e,t)=>{var i,n;return!e.multiImage||(null===(n=null===(i=t.items[0])||void 0===i?void 0:i.images)||void 0===n?void 0:n.length)>1}],je=[(e,t)=>{t.template.templateType=e.template,t.template.dynamicRenderingConfig=e.dynamicRenderingConfig&&e.dynamicRenderingConfig(t)},(e,t)=>{Object(ae.a)(t.items,t=>{if(e.supportedAssets&&Object(ee.a)(e.supportedAssets)){const i=Object(l.a)(t.assets,(t,i,n)=>(e.supportedAssets.includes(A[n])&&(t[n]=i),t),{});t.assets=i}})}],Ae=[{ratio:K.b._lowerBound,width:1,height:9999},{ratio:K.b._1by191,width:1,height:1.91},{ratio:K.b._9by16,width:9,height:16},{ratio:K.b._3by4,width:3,height:4},{ratio:K.b._1by1,width:1,height:1},{ratio:K.b._4by3,width:4,height:3},{ratio:K.b._16by9,width:16,height:9},{ratio:K.b._191by1,width:1.91,height:1}];class we{constructor(){this.filterConfigs=e=>{const t=Object(ie.a)(Oe,t=>Object(ne.a)([...Se,t.qualifier],i=>!i||i(t,e)));return t&&0!=t.length?t:ye[e.region]},this.pickConfigByWeight=e=>{let t=0;Object(ae.a)(e,e=>{t=t+e.weight||10});const i=Math.floor(Math.random()*t);let n=0;for(let t=0;t<e.length;++t)if(n+=e[t].weight||10,i<n)return e[t]},this.preProcess=e=>{Object(ae.a)(e.items,e=>{e.assets&&this.calculateDiscount(e.assets)}),(e=>{let t=e.items[0].originalImageWidth||e.items[0].imageWidth,i=e.items[0].originalImageHeight||e.items[0].imageHeight;const n=new URL(e.items[0].imageUrl).searchParams.get("c");n&&"4"!==n&&(t=e.items[0].imageWidth,i=e.items[0].imageHeight);const a=Number(t),s=Number(i);let r=1;for(;r<Ae.length&&Math.ceil(a*Ae[r].height)!==Math.ceil(s*Ae[r].width);++r)if(!(Math.ceil(a*Ae[r].height)>Math.ceil(s*Ae[r].width))){if(1==r)break;const e=1*a/s;Math.abs(e-Ae[r].width/Ae[r].height)>=Math.abs(e-Ae[r-1].width/Ae[r-1].height)&&(r-=1);break}r==Ae.length&&(r-=1),e.template.desiredRatio=Ae[r].ratio})(e)},this.postProcess=(e,t)=>{Object(ae.a)([...je,e.modifier],i=>null==i?void 0:i(e,t))},this.calculateDiscount=e=>{const t=e.price,i=e.salePrice;if(t&&i){const n=Number(t.replace(/[^0-9.-]+/g,"")),a=Number(i.replace(/[^0-9.-]+/g,""));e.discount=Math.floor((n-a)/n*100)}}}selectTemplate(e){this.preProcess(e);const t=this.filterConfigs(e),i=this.pickConfigByWeight(t);this.postProcess(i,e)}}class Ie{}Ie.concat=(e,t)=>`${e}.${t}`,Ie.identity=e=>t=>Ie.concat(e,t),Ie.boolean=e=>t=>t?Ie.concat(e,"1"):null;class Te{constructor(){this._availableAssets="",this._displayedAssets=""}get availableAssets(){return this._availableAssets}get displayedAssets(){return this._displayedAssets}setAvailableAssets(e){e.items&&e.items[0]&&e.items[0].assets&&(this._availableAssets=Object(X.a)(Object.keys(e.items[0].assets),e=>A[e]).join("_"))}setDisplayedAssets(e){e.items&&e.items[0]&&e.items[0].assets&&(this._displayedAssets=Object(X.a)(Object.keys(e.items[0].assets),e=>A[e]).join("_"))}}const Re={templateType:Ie.identity("type"),animatedImage:Ie.identity("ani"),flipZIndex:Ie.boolean("fz"),landscapeOverlay:Ie.boolean("lo")};class Pe{constructor(){this.hasAnyInlineDecoration=e=>{if(e.items&&0!==e.items.length){if(e.items[0]&&e.items[0].assets){const t=e.items[0].assets;return!!(t.price||t.salePrice||t.installmentPrice||t.rating||t.review||t.priceDrop||t.viewed||t.freeShipping)}return!1}return!1}}updateTemplate(e,t={}){if(!e||"resriver"===e.region||"resinfopane"===e.region)return;this.decorationBeaconBuilder=new Te,this.decorationBeaconBuilder.setAvailableAssets(e);const i=Object(Y.a)({},t,K.c);if(i.configType){e.template=i;(new we).selectTemplate(e)}else e.template=this.processConfig(e,i),this.resetTempateTypeForInfopaneInMultiAds(e),this.filterAssetByFlight(e),this.updatePlacementImageSize(e),this.updateTemplateTypeForPriceDiscount(e);this.updateBeacon(e)}processConfig(e,t){const i=t;if(this.updateAllowedAssetsAndTemplateForInfopane(e,i),this.updateTemplateInfoForDRInfopane(e,i),i.templateType!==K.a.Slideshow&&i.templateType!==K.a.PseudoVideo||this.updateSlideshowTemplateType(e,t,i),i.templateType===K.a.PatternOverlay){"225"===this.getItemImageSize(e).height?i.landscapeOverlay=!1:i.templateType=K.a.Default}return i.templateType===K.a.Default&&e.items&&e.items.length>3&&i.adCarousel&&(i.templateType=K.a.AdCarousel),this.updateTemplateInfoForBrandStory(e,i),i}updatePlacementImageSize(e){if(e.template.templateType===K.a.PatternOverlay){const t=this.getItemImageSize(e);e.imageWidth=Object(h.a)(e,"imageWidth",t.width),e.imageHeight=Object(h.a)(e,"imageHeight",t.height)}}updateBeacon(e){if(!Object(Z.a)(e.beaconsJson)){const t=JSON.parse(e.beaconsJson);if(t&&Object(ee.a)(t.trb)){let i=!1;t.trb=t.trb.map(t=>{if(t.includes("srtb.msn.com")){i=!0;const n=new URL(t);return f.a.appendSearchParam(n,"t",this.serializeTemplateConfig(e)),this.decorationBeaconBuilder.setDisplayedAssets(e),this.decorationBeaconBuilder.availableAssets&&f.a.appendSearchParam(n,"dec",this.decorationBeaconBuilder.availableAssets+"-"+this.decorationBeaconBuilder.displayedAssets),n.href}return t}),i&&(e.beaconsJson=JSON.stringify(t))}}}serializeTemplateConfig(e){return Object(l.a)(Re,(t,i,n)=>{const a=Object(h.a)(e.template,n);if(a){const e=i(a);if(e)return""===t?e:`${t}_${e}`}return t},"")}updateSlideshowTemplateType(e,t,i){e&&e.items&&e.items[0]&&e.items[0].images&&e.items[0].images.length>1?(i.templateType=t.templateType,e.slideshowProps=i.slideshowProps):(i.templateType=K.a.Default,i.slideshowProps=void 0)}getItemImageSize(e){const t=Object(te.a)(e.items);return Object(Z.a)(t)?{}:{width:""+Object(h.a)(t,"imageWidth"),height:""+Object(h.a)(t,"imageHeight")}}calculateDiscount(e){const t=e.price,i=e.salePrice;if(t&&i){const n=Number(t.replace(/[^0-9.-]+/g,"")),a=Number(i.replace(/[^0-9.-]+/g,""));e.discount=Math.floor((n-a)/n*100)}}filterAssetByFlight(e){if(e&&e.items&&e.items[0]&&e.items[0].assets){this.calculateDiscount(e.items[0].assets);const t=Object(l.a)(e.items[0].assets,(t,i,n)=>{var a;return Object(ee.a)(null===(a=e.template)||void 0===a?void 0:a.allowedAssets)&&e.template.allowedAssets.includes(A[n])&&(t[n]=i),t},{});e.items[0].assets=t}}resetTempateTypeForInfopaneInMultiAds(e){"infopane"===e.region&&e.items&&e.items.length>1&&e.template.templateType!==K.a.InfopaneDynamicRendering&&(e.template.templateType=K.a.Default,e.template.animatedImage="")}isValidProviderNameForBrand(e){if(!(e&&e.items&&e.items[0]&&e.items[0].providerName))return!1;const t=e.items[0].providerName;return-1===t.indexOf("/")&&t.length<20}updateAllowedAssetsAndTemplateForInfopane(e,t){t.templateType!==K.a.BrandStory&&t.templateType!==K.a.BrandStoryNoDeco&&t.templateType!==K.a.BrandStoryNoProgressiveDisplay&&t.templateType!==K.a.HotspotSingle&&t.templateType!==K.a.DiscountScribble&&t.templateType!==K.a.ContentReveal&&t.templateType!==K.a.Gamification||"infopane"===e.region&&(t.allowedAssets=void 0,t.templateType=K.a.Default)}updateTemplateInfoForBrandStory(e,t){var i,n,a,s;t.templateType!==K.a.BrandStory&&t.templateType!==K.a.BrandStoryNoDeco&&t.templateType!==K.a.BrandStoryNoProgressiveDisplay||((null===(n=null===(i=e.items)||void 0===i?void 0:i[0])||void 0===n?void 0:n.description)===(null===(s=null===(a=e.items)||void 0===a?void 0:a[0])||void 0===s?void 0:s.providerName)&&(e.items[0].description=null),this.isValidProviderNameForBrand(e)||(t.templateType=K.a.Default,t.allowedAssets=void 0))}updateTemplateTypeForPriceDiscount(e){var t,i,n,a,s,r,o,c,d,l,h,u,p,v,g,f,b,m,C;const{Default:O,HotspotSingle:y,BrandStory:S,DiscountScribble:j,ContentReveal:A,Gamification:w}=K.a;(null===(n=null===(i=null===(t=e.items)||void 0===t?void 0:t[0])||void 0===i?void 0:i.assets)||void 0===n?void 0:n.discount)>=(null===(a=e.template)||void 0===a?void 0:a.discountThreshold)||([y,j,w].includes(null===(s=e.template)||void 0===s?void 0:s.templateType)&&(e.template.templateType=O,e.template.allowedAssets=void 0,e.items[0].assets={}),(null===(r=e.template)||void 0===r?void 0:r.templateType)===A&&(null===(d=null===(c=null===(o=e.items)||void 0===o?void 0:o[0])||void 0===c?void 0:c.assets)||void 0===d||delete d.discount,(null===(h=null===(l=e.items)||void 0===l?void 0:l[0])||void 0===h?void 0:h.description)===(null===(p=null===(u=e.items)||void 0===u?void 0:u[0])||void 0===p?void 0:p.providerName)&&(e.items[0].description=null),(null===(g=null===(v=e.items)||void 0===v?void 0:v[0])||void 0===g?void 0:g.description)||this.hasAnyInlineDecoration(e)||(e.template.templateType=O,e.template.allowedAssets=void 0)),(null===(f=e.template)||void 0===f?void 0:f.templateType)===S&&(null===(C=null===(m=null===(b=e.items)||void 0===b?void 0:b[0])||void 0===m?void 0:m.assets)||void 0===C||delete C.discount))}updateTemplateInfoForDRInfopane(e,t){"river"===e.region||"infopane"==e.region&&t.templateType===K.a.InfopaneDynamicRendering||(t.templateType=K.a.Default),"river"===e.region&&t.templateType===K.a.InfopaneDynamicRendering&&(t.templateType=K.a.Default)}}var Me=i("b169");class ke{constructor(){this.beaconService=new v.a,this.cmsService=new S,this.samService=new _,this.templateService=new Pe,this.cmsNativeAdsItemsMap=new Map,this.cmsRetryCount=0,this.backfillIndex=0,this.cmsAdsCounter=0,this.callbackFnPlacementList=[],this.callbackList=[]}resetNativeAdService(){this.backfillIndex=0,this.cmsAdsCounter=0,this.callbackFnPlacementList.length=0,this.callbackList.length=0,this.samService.clearPreviousInfo()}fetchNativeAds(e){return Object(a.a)(this,void 0,void 0,(function*(){if(!e||!e.placements||0===e.placements.length)return void y.a.sendAppErrorEvent(Object(s.a)(r.Fe,"Fetch NativeAd failed","No placements found in the request"));if(e.locale||(e.locale=I.b.Locale),!e.locale)return void y.a.sendAppErrorEvent(Object(s.a)(r.Fe,"Fetch NativeAd failed",`No locale found, headData.Locale: ${I.b.Locale}, adRequest.locale: ${e.locale}`));const t=this.samService.fetchSAMAds(e),i=e.locale,n=C.c[i];if(!this.cmsItems){const e=yield this.cmsService.getCMSList(n,i);e&&(this.cmsItems=e.items)}const a=this.buildAdResponse(e),o=yield t;return this.updateAdResponse(a,this.cmsItems,n,o),a}))}updateAdResponse(e,t,i,n){const a=!t||0==t.length,d=!n||!n.placements||0==n.placements.length;if(a&&d)return void y.a.sendAppErrorEvent(Object(s.a)(r.Ge,"Fetch NativeAd failed",`Unable to retrieve backfill list id: ${i} and SAM response`));a&&y.a.sendAppErrorEvent(Object(s.a)(r.Ge,"Unable to retrieve backfill list","Backfill list id: "+i));const l=this.mapSAMPlacements(n);return e.pageViewId=n&&n.metaData&&n.metaData.pageViewId,e.placements.forEach(e=>{const i=e.region+e.regionIndex,n=l.get(i);if(n&&n.items&&n.items.length>0){n.items.forEach(t=>{const i={title:t.title,destinationUrl:t.url,imageUrl:t.imageUrl,providerName:t.sourceName,adChoiceIconUrl:t.adChoicesUrl,imageHeight:t.imageHeight,imageWidth:t.imageWidth,clickBeacons:t.clickBeacons,uniqueId:t.uniqueId,feedbackUrl:Object(p.a)(t.clickBeacons),verificationParameters:t.verificationParameters};e.items.push(i)}),e.privacyUrl=n.privacyUrl,e.adServedUrls=n.adServedUrls,e.jsTrackerUrls=n.jsTrackerUrls,e.visibilityUrls=n.visibilityUrls,e.beaconsJson=n.beaconsJson,e.bingTrackerUrls=n.bingTrackerUrls,e.geminiViewabilityDataJson=n.geminiViewabilityDataJson,this.beaconService.fireAdServedTrackingCall(n.beaconsJson);const t=!0===I.b.IsPrerender?performance.now()-Object(o.j)(c.e):performance.now();Object(o.q)(j.a.TimeToServeAd,t)}else if(a)y.a.sendAppErrorEvent(Object(s.a)(r.F,"Unable to backfill invalid sam placement","Placement key: "+i));else{const i=this.backfillIndex++%t.length,n=t[i],a={title:n.title,destinationUrl:n.url,imageUrl:this.updateImageUrl(e,n.imageUrl),providerName:n.provider?n.provider.name:""};e.items.push(a),e.privacyUrl=n.privacyUrl}}),e}fetchSamAds(e,t=!1,i){return Object(a.a)(this,void 0,void 0,(function*(){if(!e||!e.placements||0===e.placements.length)return void y.a.sendAppErrorEvent(Object(s.a)(r.Fe,"Fetch NativeAd failed","No placements found in the request"));if(e.locale||(e.locale=I.b.Locale),!e.locale)return void y.a.sendAppErrorEvent(Object(s.a)(r.Fe,"Fetch NativeAd failed",`No locale found, headData.Locale: ${I.b.Locale}, adRequest.locale: ${e.locale}`));i&&i.length>0&&this.callbackList.push(...i),this.locale=e.locale;const n=this.samService.fetchSAMAds(e,t);return{placeHolderResponse:this.buildAdResponse(e),samResponse:yield n}}))}fetchCmsAds(e,t,i){return Object(a.a)(this,void 0,void 0,(function*(){if(!e||!e.placements||0===e.placements.length)return void y.a.sendAppErrorEvent(Object(s.a)(r.Fe,"Fetch NativeAd failed","No placements found in the request"));const n=I.b.Locale;if(!this.cmsNativeAdsItemsMap.has(t)){const e=yield this.cmsService.getCMSList(t,n);e&&e.id&&e.items&&this.cmsNativeAdsItemsMap.set(t,e.items)}const a=this.buildAdResponse(e),o=this.cmsNativeAdsItemsMap.has(t)?this.cmsNativeAdsItemsMap.get(t):[];for(const e of a.placements){const t=i.shift();let a,s;if(t){let e=parseInt(t,10);if(e)e=Math.max(e-1,0),e=e<o.length?e:e%o.length,a=o[e];else{if(!this.cmsNativeAdsItemsMap.has(t)){const e=yield this.cmsService.getCMSList(t,n);e&&e.id&&e.items&&this.cmsNativeAdsItemsMap.set(t,e.items)}const e=this.cmsNativeAdsItemsMap.has(t)?this.cmsNativeAdsItemsMap.get(t):[];a=Object(d.a)(e)[0],a||(a=o[this.cmsAdsCounter%o.length])}}else a=o[this.cmsAdsCounter%o.length];a&&(s={title:a.title,destinationUrl:a.url,imageUrl:this.updateImageUrl(e,a.imageUrl),providerName:a.provider?a.provider.name:""},e.items.push(s),e.privacyUrl=a.privacyUrl),this.cmsAdsCounter++}return a}))}updateSamAdResponse(e,t,i){const n=this.cmsItems,a=this.mapSAMPlacements(t),s=!n||0==n.length;return e.pageViewId=t&&t.metaData&&t.metaData.pageViewId,e.placements.forEach(e=>{const t=e.region+e.regionIndex,r=a.get(t);if(r&&r.items&&r.items.length>0){r.items.forEach(t=>{const i={title:t.title,description:t.description,destinationUrl:t.url,providerName:t.sourceName,adChoiceIconUrl:t.adChoicesUrl,imageUrl:t.imageUrl,imageHeight:t.imageHeight,imageWidth:t.imageWidth,images:t.images,clickBeacons:t.clickBeacons,uniqueId:t.uniqueId,beaconsJson:t.beaconsJson,feedbackUrl:Object(p.a)(t.clickBeacons),originalImageWidth:t.originalImageWidth,originalImageHeight:t.originalImageHeight,verificationParameters:t.verificationParameters};this.updateAssetVideoField(i,t.assets),this.updateAssetDataFields(i,t.assets),e.items.push(i)});const t=Object(Me.a)(e,0);e.videoViewabilityData=t?t.ViewabilityProps:null,e.privacyUrl=r.privacyUrl,e.adServedUrls=r.adServedUrls,e.jsTrackerUrls=r.jsTrackerUrls,e.visibilityUrls=r.visibilityUrls,e.beaconsJson=r.beaconsJson,e.bingTrackerUrls=r.bingTrackerUrls,e.geminiViewabilityDataJson=r.geminiViewabilityDataJson,e.providerId=r.providerId;const n=!0===I.b.IsPrerender?performance.now()-Object(o.j)(c.e):performance.now();Object(o.q)(j.a.TimeToServeAd,n),this.templateService.updateTemplate(e,i)}else if(s)this.handleCmsStandyPlacement(e);else{const t=this.backfillIndex++%n.length,i=n[t],a={title:i.title,destinationUrl:i.url,imageUrl:this.updateImageUrl(e,i.imageUrl),providerName:i.provider?i.provider.name:""};e.items.push(a),e.privacyUrl=i.privacyUrl,e.isBackfill=!0}}),e}handleCmsStandyPlacement(e){if(this.cmsItems){const t=this.cmsItems;for(const i of this.callbackFnPlacementList){const n=t[this.backfillIndex++%t.length],a={title:n.title,destinationUrl:n.url,imageUrl:this.updateImageUrl(e,n.imageUrl),providerName:n.provider?n.provider.name:""};i.items.push(a),i.privacyUrl=n.privacyUrl,i.isBackfill=!0}this.callbackList.forEach(e=>{e(this)}),this.callbackList=[],this.callbackFnPlacementList=[]}else e&&this.callbackFnPlacementList.push(e)}loadCmsBackFillList(){const e=this.locale?this.locale:I.b.Locale,t=C.c[e];t&&!this.cmsItems&&this.cmsService.getCMSList(t,e).then(e=>{e?(this.cmsItems=e.items,this.handleCmsStandyPlacement()):++this.cmsRetryCount<10&&this.loadCmsBackFillList()})}mapSAMPlacements(e){const t=new Map;return e&&e.placements&&e.placements.forEach(e=>{e.region&&e.index&&t.set(e.region+e.index,e)}),t}buildAdResponse(e){const t=[];e.placements.forEach(e=>{e.region&&e.indices&&e.indices.length&&e.indices.forEach(i=>{const n={region:e.region,regionIndex:i,imageHeight:e.img&&e.img.h&&e.img.h.toString(),imageWidth:e.img&&e.img.w&&e.img.w.toString(),items:[]};t.push(n)})});return{placements:t,adLabelText:Object(p.b)(e.locale),isGreyAdsLabelEnabled:C.g.includes(e.locale),privacyUrl:C.b.PrivacyUrl}}updateImageUrl(e,t){return e&&e.imageWidth&&e.imageHeight&&t?t.replace("w=624","w="+e.imageWidth).replace("h=350","h="+e.imageHeight):t}updateAssetDataFields(e,t){const i=Object(l.a)(t,(e,t)=>{const i=Object(h.a)(t,"data.type"),n=Object(u.a)(A,e=>e===i);return n&&(e[n]=Object(h.a)(t,"data.value")),e},{});e.assets=i}updateAssetVideoField(e,t){t&&t.length>0&&t.forEach(t=>{const i=Object(h.a)(t,"video.vasttag");i&&(e.video=i)})}getAdTagStyleByLocale(e){const t=null!=e?e:I.b.Locale;return{adLabelText:Object(p.b)(t),isGreyAdsLabelEnabled:C.g.includes(t)}}}let Ee;function Fe(){return Ee||(Ee=new ke),Ee.resetNativeAdService(),Ee}},ejtM:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("cxul"),a=i("LJMo"),s=i("HxRh"),r=i("K1Uj"),o=i("u5KZ"),c=i("W+kI"),d=i("C/Vb");const l={[n.b.contentCard]:(e,t,i)=>{var n;e.isProviderInFooter=i.config.isProviderInFooter,(null===(n=i.config.childExperienceReferencesWC)||void 0===n?void 0:n.socialBarWC)&&Object(d.a)(i.config.childExperienceReferencesWC.socialBarWC)},[n.b.infopaneCard]:(e,t,i)=>{var n,a,s;e.activeIndicator=!1,e.autoRotateIntervalMs=1e3*(null===(n=null==t?void 0:t.wpoMetadata)||void 0===n?void 0:n.infopaneRemainingSlidesTransitionSpeedInSeconds)||i.config.autoRotateIntervalMs||5e3,e.firstAutoRotateIntervalMs=1e3*(null===(a=null==t?void 0:t.wpoMetadata)||void 0===a?void 0:a.infopaneFirstSlideTransitionSpeedInSeconds)||i.config.firstAutoRotateIntervalMs,e.disableAutoRotate=i.config.disableAutoRotate,Object(c.a)().get("vpFreeze")&&(e.disableAutoRotate=!0),i.config.useColorfulInfopane||delete e.configOptions.useArticleCardTemplate,(null===(s=i.config.childExperienceReferencesWC)||void 0===s?void 0:s.socialBarWC)&&Object(d.a)(i.config.childExperienceReferencesWC.socialBarWC)},[n.b.moneyCard]:(e,t,i)=>{i.money&&(e.cardStateData=i.money.moneyStateManager.getMoneyState(),e.handleNavClick=i.handleMoneyNavClick,e.handleAddToWatchlist=i.money.handleAddToWatchlist,e.refreshMoneyCardData=i.handleRefreshMoneyData,e.cardLayout=r.a.full)},[n.b.comicsCarouselCard]:(e,t,i)=>{var n;h(e,null===(n=i.config.childExperienceReferencesWC)||void 0===n?void 0:n.selectCarousel)},[n.b.selectCarouselCard]:(e,t,i)=>{var n;h(e,null===(n=i.config.childExperienceReferencesWC)||void 0===n?void 0:n.selectCarousel)},[n.b.editorsPickCarouselCard]:(e,t,i)=>{var n;h(e,null===(n=i.config.childExperienceReferencesWC)||void 0===n?void 0:n.selectCarousel)},[n.b.dailyFixGamesCarouselCard]:(e,t,i)=>{var n;h(e,null===(n=i.config.childExperienceReferencesWC)||void 0===n?void 0:n.selectCarousel)},[n.b.localNewsCarouselCard]:(e,t,i)=>{var n;h(e,null===(n=i.config.childExperienceReferencesWC)||void 0===n?void 0:n.selectCarousel)},[n.b.webNewsCarouselCard]:(e,t,i)=>{var n;h(e,null===(n=i.config.childExperienceReferencesWC)||void 0===n?void 0:n.selectCarousel)},[n.b.mangaCarouselCard]:(e,t,i)=>{var n;h(e,null===(n=i.config.childExperienceReferencesWC)||void 0===n?void 0:n.selectCarousel)},[n.b.shoppingCarouselCard]:(e,t,i)=>{var n,s;t.type===a.a.ShoppingCard&&(null===(n=i.config.childExperienceReferencesWC)||void 0===n?void 0:n.shoppingCard)&&(e.configOptions=i.config.childExperienceReferencesWC.shoppingCard),t.type===a.a.ShoppingCarousel&&(null===(s=i.config.childExperienceReferencesWC)||void 0===s?void 0:s.shoppingCarousel)&&(e.configOptions=i.config.childExperienceReferencesWC.shoppingCarousel)},[n.b.weatherCard]:(e,t,i)=>{var n;(null===(n=i.config.childExperienceReferencesWC)||void 0===n?void 0:n.weatherCard)&&(Object(d.a)(i.config.childExperienceReferencesWC.weatherCard),e.configOptions=i.config.childExperienceReferencesWC.weatherCard)},[n.b.coldStartCard]:(e,t,i,n)=>{var a;const r=i.config.expectedColdStartPosition;r&&r>=0&&n+1!==r&&o.a.sendAppErrorEvent(s.Db);const c=null===(a=i.config.childExperienceReferencesWC)||void 0===a?void 0:a.coldStartRiverCard;c&&Object(d.a)(c),e.upsellGetStartedClickHandler=i.config.upsellLaunchesInline?void 0:i.initializeColdStartExperience},[n.b.newsSegmentCarousel]:(e,t,i)=>{var n;h(e,null===(n=i.config.childExperienceReferencesWC)||void 0===n?void 0:n.newsSegmentCarousel)},[n.b.horoscopeAnswerCard]:(e,t,i)=>{var n;h(e,null===(n=i.config.childExperienceReferencesWC)||void 0===n?void 0:n.horoscopeCard)},[n.b.electionsCard]:(e,t,i)=>{var n;h(e,null===(n=i.config.childExperienceReferencesWC)||void 0===n?void 0:n.electionsCard)},[n.b.bingVideoCarousel]:(e,t,i)=>{var n;h(e,null===(n=i.config.childExperienceReferencesWC)||void 0===n?void 0:n.bingVideoCarousel)},[n.b.denseCard]:(e,t,i)=>{var n;h(e,null===(n=i.config.childExperienceReferencesWC)||void 0===n?void 0:n.denseCard)},[n.b.recommendedSearchCarousel]:(e,t,i)=>{var n;h(e,null===(n=i.config.childExperienceReferencesWC)||void 0===n?void 0:n.recommendedSearchCarousel)},[n.b.trendingNowCard]:(e,t,i)=>{var n;h(e,null===(n=i.config.childExperienceReferencesWC)||void 0===n?void 0:n.trendingNowWC)},[n.b.moneyInfoCardWC]:(e,t,i)=>{var n;h(e,null===(n=i.config.childExperienceReferencesWC)||void 0===n?void 0:n.moneyInfoCardWC)},[n.b.healthCard]:(e,t,i)=>{var n;h(e,null===(n=i.config.childExperienceReferencesWC)||void 0===n?void 0:n.bingHealthCard)},[n.b.onThisDayCard]:(e,t,i)=>{var n;h(e,null===(n=i.config.childExperienceReferencesWC)||void 0===n?void 0:n.onThisDayCard)},[n.b.lotteryCard]:(e,t,i)=>{var n;h(e,null===(n=i.config.childExperienceReferencesWC)||void 0===n?void 0:n.lotteryCard)},[n.b.qnaCard]:(e,t,i)=>{var n;h(e,null===(n=i.config.childExperienceReferencesWC)||void 0===n?void 0:n.qnaCard)},[n.b.recipesCard]:(e,t,i)=>{var n;h(e,null===(n=i.config.childExperienceReferencesWC)||void 0===n?void 0:n.recipesCard)},[n.b.esportsCard]:(e,t,i)=>{var n;h(e,null===(n=i.config.childExperienceReferencesWC)||void 0===n?void 0:n.esportsCard)},[n.b.trafficCard]:(e,t,i)=>{var n;h(e,null===(n=i.config.childExperienceReferencesWC)||void 0===n?void 0:n.trafficCard)},[n.b.travelDestinationCard]:(e,t,i)=>{var n;h(e,null===(n=i.config.childExperienceReferencesWC)||void 0===n?void 0:n.travelDestination)},[n.b.sportsCard]:(e,t,i)=>{var n;(null===(n=i.config.childExperienceReferencesWC)||void 0===n?void 0:n.sportsCard)&&(Object(d.a)(i.config.childExperienceReferencesWC.sportsCard),e.configOptions=i.config)},[n.b.sportsOlympicCard]:(e,t,i)=>{var n;h(e,null===(n=i.config.childExperienceReferencesWC)||void 0===n?void 0:n.sportsOlympicCard)},[n.b.electionsCard]:(e,t,i)=>{var n;h(e,null===(n=i.config.childExperienceReferencesWC)||void 0===n?void 0:n.electionsCard)}},h=(e,t)=>{t?(Object(d.a)(t),e.configOptions=t):e.configOptions=null}},eupA:function(e,t,i){"use strict";var n=i("JFdr");t.a=function(e,t){var i=-1,a=e.length,s=a-1;for(t=void 0===t?a:t;++i<t;){var r=Object(n.a)(i,s),o=e[r];e[r]=e[i],e[i]=o}return e.length=t,e}},hV4J:function(e,t,i){"use strict";var n=i("2JSu"),a=i("HVAe"),s=i("p6Gq"),r=i("MyC+"),o=Object.prototype,c=o.hasOwnProperty,d=Object(n.a)((function(e,t){e=Object(e);var i=-1,n=t.length,d=n>2?t[2]:void 0;for(d&&Object(s.a)(t[0],t[1],d)&&(n=1);++i<n;)for(var l=t[i],h=Object(r.a)(l),u=-1,p=h.length;++u<p;){var v=h[u],g=e[v];(void 0===g||Object(a.a)(g,o[v])&&!c.call(e,v))&&(e[v]=l[v])}return e}));t.a=d},hme2:function(e,t,i){"use strict";i.d(t,"a",(function(){return O}));var n=i("D57K"),a=i("OkDC"),s=i("tMmC"),r=i("HxRh"),o=i("ypwz"),c=i("tERu"),d=i("rvYQ"),l=i("msIb"),h=i("6ADy"),u=i("/+Un"),p=i("KETb");class v{constructor(e){this.fetchImpl=e,this.actionsEndpoint="./Graph/Actions",this.defaultOcid="Peregrine"}sendPostActionRequest(e,t=this.defaultOcid,i=!0){return Object(n.a)(this,void 0,void 0,(function*(){const a=JSON.stringify(e),s={method:"POST",body:a,headers:yield l.a.getOneServiceHeaders()};(yield Object(u.e)())&&(s.credentials="include");const r=Object(h.c)(this.actionsEndpoint);(yield l.a.getCommonParams2(t,i)).forEach(e=>e.value&&r.searchParams.set(e.key,e.value));return yield Object(p.b)(()=>Object(n.a)(this,void 0,void 0,(function*(){const e=yield this.fetchImpl(r.href,s);if(e.status>=400){const t=`OneService returned error response. Status: ${e.status} for Post request: ${r.href} with params ${JSON.stringify(s)}`;throw new Error(t)}return e})),"postAction"+a)}))}sendDeleteActionRequest(e,t=this.defaultOcid,i=!0){return Object(n.a)(this,void 0,void 0,(function*(){const a=yield l.a.getBaseRequestData("DELETE");(yield Object(u.e)())&&(a.credentials="include");let s="";const r=Object.keys(e),o=r.length;for(let t=0;t<o;t++)s+=`${r[t]} eq '${e[r[t]]}'`,t!=o-1&&o>1&&(s+=" and ");const c={key:"$filter",value:s},d=Object(h.c)(this.actionsEndpoint);[c,...yield l.a.getCommonParams2(t,i)].forEach(e=>e.value&&d.searchParams.set(e.key,e.value));return yield Object(p.b)(()=>Object(n.a)(this,void 0,void 0,(function*(){const e=yield this.fetchImpl(d.href,a);if(e.status>=400){const t=`OneService returned error response. Status: ${e.status} for Delete request: ${d.href} with params: ${JSON.stringify(a)}`;throw new Error(t)}return e})),"deleteAction"+s)}))}}var g=i("ac9z"),f=i("u5KZ"),b=i("HDSB");class m extends class{constructor(e){this.fetchImpl=e,this.ocid="feeds",this.freServiceEndpoint="news/fre",this.userEndpoint="./msn/user",this.addPageInfoToOcid=!0,this.actionsClient=new v(e),d.a.AppType!==o.a.NewsAndInterests&&d.a.AppType!==o.a.WindowsNewsPlus||(this.addPageInfoToOcid=!1,this.ocid="winp2")}getFreArtifacts(){return Object(n.a)(this,void 0,void 0,(function*(){const e=Object(h.c)(this.freServiceEndpoint);e.searchParams.set("bypass_trigger","true");return[...(yield Object(u.d)())===c.c.SignedIn?l.a.getOneServiceParamsWithAuth(Object(d.b)().UserId,this.ocid,this.addPageInfoToOcid):l.a.getOneServiceParamsWithoutAuth(Object(d.b)().UserId,this.ocid,this.addPageInfoToOcid),{key:g.a,value:Date.now().toString()}].forEach(t=>{t.value&&e.searchParams.set(t.key,t.value)}),this.getFreArtifactsWithUrl(e.href)}))}getFreArtifactsWithUrl(e){return Object(n.a)(this,void 0,void 0,(function*(){if(!e||"-1"===e)return null;const t={method:a.d.Get,credentials:"include",headers:yield l.a.getOneServiceHeaders()};try{const i=yield Object(p.b)(()=>Object(n.a)(this,void 0,void 0,(function*(){return yield this.fetchImpl(e,t)})),"getFreArtifacts");if(!i.ok)throw Error("[FreServiceClient.getFreArtifacts] Failed with response: "+JSON.stringify(i));const a=i.headers&&i.headers.get("ddd-tmpl");return f.a.addOrUpdateTmplString(a),i.json()}catch(e){throw s.a.logError(e.message),e}}))}setFreArtifactForUser(e,t){return Object(n.a)(this,void 0,void 0,(function*(){if(e&&t){const i={method:t,credentials:"include",headers:yield l.a.getOneServiceHeaders()};Object(h.c)(this.freServiceEndpoint);let a=0;try{if(a=(yield Object(p.b)(()=>Object(n.a)(this,void 0,void 0,(function*(){return yield this.fetchImpl(e,i)})),"setFreArtifact")).status,a>=400){const e=`OneService returned error response. Status: ${a} for done action`;throw new Error(e)}}catch(e){return s.a.logError(e.message),a}return a}return f.a.sendAppErrorEvent(Object.assign(Object.assign({},r.Eh),{message:`Any of the required parameters was not properly set by the caller. callbackUrl: ${e} method: ${t}.`})),0}))}updateArtifactInActionsEndpoint(e,t){return Object(n.a)(this,void 0,void 0,(function*(){let i;a.a[e.type]&&(i=Object.assign({},a.a[e.type])),i.targetId=e.id;try{t?yield this.actionsClient.sendPostActionRequest(i,this.ocid,this.addPageInfoToOcid):yield this.actionsClient.sendDeleteActionRequest(i,this.ocid,this.addPageInfoToOcid),Object(g.d)()}catch(i){return f.a.sendAppErrorEvent(Object.assign(Object.assign({},r.ze),{message:"Fre Actions call failed",pb:Object.assign(Object.assign({},r.ze.pb),{customMessage:`artifact: ${JSON.stringify(e)} following: ${t} error message: ${i}`})})),!1}return!0}))}setDoneFreState(){return Object(n.a)(this,void 0,void 0,(function*(){yield this.setFreState(JSON.stringify({stage:a.b}),r.Kb)}))}setMaybeLaterFreState(){return Object(n.a)(this,void 0,void 0,(function*(){yield this.setFreState(JSON.stringify({dismiss_timestamp:new Date(Date.now()).toJSON()}),r.Be)}))}setFreState(e,t){return Object(n.a)(this,void 0,void 0,(function*(){const i={method:"POST",body:JSON.stringify({freMultiStepState:e}),headers:yield l.a.getOneServiceHeaders()};(yield Object(u.d)())===c.c.SignedIn&&(i.credentials="include");const a=Object(h.c)(this.userEndpoint);(yield l.a.getCommonParams2(this.ocid,this.addPageInfoToOcid)).forEach(e=>e.value&&a.searchParams.set(e.key,e.value));try{yield Object(p.b)(()=>Object(n.a)(this,void 0,void 0,(function*(){const e=yield this.fetchImpl(a.href,i);if(e.status>=400){const t=`OneService returned error response. Status: ${e.status} for call to set user state`;throw new Error(t)}return e.json()})),"sendFreDoneAction")}catch(i){f.a.sendAppErrorEvent(Object.assign(Object.assign({},t),{message:"Service call to set fre state failed",pb:Object.assign(Object.assign({},t.pb),{customMessage:`state: ${e} error: ${i}`})}))}}))}}{constructor(e){let t;t=e||(Object(b.a)()?window.fetch.bind(window):fetch),super(t)}}let C;const O=e=>C||(C=new m(e),C)},mEtE:function(e,t,i){"use strict";t.a=function(e){return e&&e.length?e[0]:void 0}},mOQN:function(e,t,i){"use strict";var n=i("oKML"),a=i("FoV5");t.a=function(e){return null==e?[]:Object(n.a)(e,Object(a.a)(e))}},mXQk:function(e,t,i){"use strict";i.d(t,"d",(function(){return n})),i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return s})),i.d(t,"c",(function(){return r})),i.d(t,"e",(function(){return o})),i.d(t,"f",(function(){return c})),i.d(t,"g",(function(){return d})),i.d(t,"h",(function(){return l}));const n={ColdStart:"ColdStart",UpsellGetStartedButton:"GetStarted"},a="cold-start-close",s="cold-start-confirm",r="cold-start-selection-done",o={Article:{width:148,height:108},Provider:{width:64,height:64},Topic:{width:200,height:200}},c=10,d="https://img-s-msn-com.akamaized.net/tenant/amp/entityid/AAtCmK3.img",l="coldStartUpsell"},oKML:function(e,t,i){"use strict";var n=i("mr4r");t.a=function(e,t){return Object(n.a)(t,(function(t){return e[t]}))}},pMIE:function(e,t,i){"use strict";var n=i("/XsO"),a=i("eupA");var s=function(e){return Object(a.a)(Object(n.a)(e))},r=i("mOQN");var o=function(e){return Object(a.a)(Object(r.a)(e))},c=i("SEb4");t.a=function(e){return(Object(c.a)(e)?s:o)(e)}},rGfm:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("G82u");class a{}a.refreshRiver=new n.a("RiverRefresh"),a.repaintRiver=new n.a("RiverRepaint"),a.riverRefreshed=new n.a("RiverRefreshed"),a.riverQueryUpdated=new n.a("RiverQueryUpdated"),a.riverLocationUpdated=new n.a("RiverLocationUpdated")},roS3:function(e,t,i){"use strict";var n=i("B1m9");t.a=function(e,t){return t="function"==typeof t?t:void 0,Object(n.a)(e,5,t)}},sljh:function(e,t,i){"use strict";var n=i("rkDk");t.a=function(e,t){var i=[];return Object(n.a)(e,(function(e,n,a){t(e,n,a)&&i.push(e)})),i}},uEVT:function(e,t,i){"use strict";var n=i("aGtQ"),a=i("sljh"),s=i("wh7w"),r=i("SEb4");t.a=function(e,t){return(Object(r.a)(e)?n.a:a.a)(e,Object(s.a)(t,3))}}}]);